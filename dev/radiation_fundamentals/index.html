<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Radiation Fundamentals · GasChem.jl</title><meta name="title" content="Radiation Fundamentals · GasChem.jl"/><meta property="og:title" content="Radiation Fundamentals · GasChem.jl"/><meta property="twitter:title" content="Radiation Fundamentals · GasChem.jl"/><meta name="description" content="Documentation for GasChem.jl."/><meta property="og:description" content="Documentation for GasChem.jl."/><meta property="twitter:description" content="Documentation for GasChem.jl."/><meta property="og:url" content="https://gaschem.earthsci.dev/radiation_fundamentals/"/><meta property="twitter:url" content="https://gaschem.earthsci.dev/radiation_fundamentals/"/><link rel="canonical" href="https://gaschem.earthsci.dev/radiation_fundamentals/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChem.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../AtmosphericLifetime/">Atmospheric Lifetime</a></li><li><a class="tocitem" href="../superfast/">SuperFast</a></li><li><span class="tocitem">GEOS-Chem</span><ul><li><a class="tocitem" href="../geoschem/overview/">Overview</a></li><li><a class="tocitem" href="../geoschem/states/">State Variables</a></li><li><a class="tocitem" href="../geoschem/params/">Parameters</a></li></ul></li><li><span class="tocitem">Seinfeld &amp; Pandis Ch. 6</span><ul><li><a class="tocitem" href="../oh_production/">OH Production</a></li><li><a class="tocitem" href="../nox_photochemistry/">NOx Photochemistry</a></li><li><a class="tocitem" href="../co_oxidation/">CO Oxidation</a></li><li><a class="tocitem" href="../methane_oxidation/">Methane Oxidation</a></li><li><a class="tocitem" href="../combined_system/">Combined System</a></li></ul></li><li class="is-active"><a class="tocitem" href>Radiation Fundamentals</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="../StratosphericChemistry/">Stratospheric Chemistry</a></li><li><a class="tocitem" href="../climate_forcing/">Climate Forcing</a></li><li><a class="tocitem" href="../composing_models/">Composing models</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Radiation Fundamentals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Radiation Fundamentals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl/blob/main/docs/src/radiation_fundamentals.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Radiation-Fundamentals"><a class="docs-heading-anchor" href="#Radiation-Fundamentals">Radiation Fundamentals</a><a id="Radiation-Fundamentals-1"></a><a class="docs-heading-anchor-permalink" href="#Radiation-Fundamentals" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements the fundamental atmospheric radiation equations from Chapter 4 &quot;Atmospheric Radiation and Photochemistry&quot; of Seinfeld and Pandis (2006). These equations form the foundation for understanding radiative transfer in the atmosphere, including solar radiation, thermal emission, and planetary energy balance.</p><p>The equations describe:</p><ul><li><strong>Photon energy relationships</strong> (Eq. 4.1): The quantum nature of electromagnetic radiation</li><li><strong>Planck&#39;s blackbody radiation law</strong> (Eq. 4.2): Spectral distribution of thermal radiation</li><li><strong>Wien&#39;s displacement law</strong> (Eq. 4.3): Peak wavelength of blackbody emission</li><li><strong>Stefan-Boltzmann law</strong> (Eq. 4.4): Total thermal radiation power</li><li><strong>Planetary energy balance</strong> (Eqs. 4.5-4.7): Earth&#39;s equilibrium temperature</li><li><strong>Climate sensitivity</strong> (Eqs. 4.8-4.10): Temperature response to radiative forcing</li><li><strong>Top-of-atmosphere radiative forcing</strong> (Eq. 4.11): Net energy flux at TOA</li></ul><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition. John Wiley &amp; Sons, Inc., Hoboken, New Jersey. Chapter 4, pp. 98-106.</p><article><details class="docstring" open="true"><summary id="GasChem.PhotonEnergy"><a class="docstring-binding" href="#GasChem.PhotonEnergy"><code>GasChem.PhotonEnergy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhotonEnergy(; name=:PhotonEnergy)</code></pre><p>Implements the photon energy equation (Eq. 4.1) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">Δε = hν = hc/λ</code></pre><p>The energy of a photon is related to its frequency (ν) or wavelength (λ) through Planck&#39;s constant (h) and the speed of light (c).</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>Δε</code>: Photon energy (J)</li><li><code>ν</code>: Frequency (Hz = s⁻¹)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>λ</code>: Wavelength (m) - input parameter</li></ul><p><strong>Constants</strong></p><ul><li><code>h</code>: Planck&#39;s constant = 6.626 × 10⁻³⁴ J·s</li><li><code>c</code>: Speed of light = 2.9979 × 10⁸ m/s</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L1-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.BlackbodyRadiation"><a class="docstring-binding" href="#GasChem.BlackbodyRadiation"><code>GasChem.BlackbodyRadiation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">BlackbodyRadiation(; name=:BlackbodyRadiation)</code></pre><p>Implements Planck&#39;s blackbody radiation law (Eq. 4.2) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">F_B(λ) = 2πc²hλ⁻⁵ / (exp(ch/kλT) - 1)</code></pre><p>This equation gives the monochromatic emissive power of a blackbody at temperature T for a given wavelength λ.</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>F_B_λ</code>: Monochromatic emissive power (W m⁻³)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>T</code>: Temperature (K)</li><li><code>λ</code>: Wavelength (m)</li></ul><p><strong>Constants</strong></p><ul><li><code>h</code>: Planck&#39;s constant = 6.626 × 10⁻³⁴ J·s</li><li><code>c</code>: Speed of light = 2.9979 × 10⁸ m/s</li><li><code>k</code>: Boltzmann constant = 1.381 × 10⁻²³ J/K</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L48-L72">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.WienDisplacement"><a class="docstring-binding" href="#GasChem.WienDisplacement"><code>GasChem.WienDisplacement</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">WienDisplacement(; name=:WienDisplacement)</code></pre><p>Implements Wien&#39;s displacement law (Eq. 4.3) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">λ_max = 2.897 × 10⁻³ / T  (SI: λ_max in m, T in K)</code></pre><p>Note: S&amp;P express this as λ<em>max = 2.897 × 10⁶ / T when λ</em>max is in nm.</p><p>This gives the wavelength at which the blackbody emission spectrum peaks.</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>λ_max</code>: Peak wavelength (m)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>T</code>: Temperature (K)</li></ul><p><strong>Constants</strong></p><ul><li><code>b</code>: Wien&#39;s displacement constant = 2.897 × 10⁻³ m·K</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L98-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.StefanBoltzmann"><a class="docstring-binding" href="#GasChem.StefanBoltzmann"><code>GasChem.StefanBoltzmann</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">StefanBoltzmann(; name=:StefanBoltzmann)</code></pre><p>Implements the Stefan-Boltzmann law (Eq. 4.4) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">F_B = σT⁴</code></pre><p>The total emissive power of a blackbody integrated over all wavelengths.</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>F_B</code>: Total blackbody emissive power (W/m²)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>T</code>: Temperature (K)</li></ul><p><strong>Constants</strong></p><ul><li><code>σ</code>: Stefan-Boltzmann constant = 5.671 × 10⁻⁸ W m⁻² K⁻⁴</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L143-L163">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.PlanetaryEnergyBalance"><a class="docstring-binding" href="#GasChem.PlanetaryEnergyBalance"><code>GasChem.PlanetaryEnergyBalance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PlanetaryEnergyBalance(; name=:PlanetaryEnergyBalance)</code></pre><p>Implements the planetary energy balance equations (Eqs. 4.5-4.7) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">F_S = S₀/4 × (1 - R_p)     (Eq. 4.5 - Absorbed solar flux)
F_L = σT_e⁴                 (Eq. 4.6 - Emitted longwave flux)
T_e = ((1 - R_p)S₀/4σ)^(1/4) (Eq. 4.7 - Equilibrium temperature)</code></pre><p>At equilibrium: F<em>S = F</em>L</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>F_S</code>: Absorbed solar flux (W/m²)</li><li><code>F_L</code>: Emitted longwave flux (W/m²)</li><li><code>T_e</code>: Planetary equilibrium temperature (K)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>S_0</code>: Solar constant = 1370 W/m² (can be varied)</li><li><code>R_p</code>: Planetary albedo ~ 0.3 (can be varied)</li></ul><p><strong>Constants</strong></p><ul><li><code>σ</code>: Stefan-Boltzmann constant = 5.671 × 10⁻⁸ W m⁻² K⁻⁴</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L185-L210">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.ClimateSensitivity"><a class="docstring-binding" href="#GasChem.ClimateSensitivity"><code>GasChem.ClimateSensitivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ClimateSensitivity(; name=:ClimateSensitivity)</code></pre><p>Implements the climate sensitivity equations (Eqs. 4.8-4.10) from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">ΔF_net = ΔF_S - ΔF_L       (Eq. 4.8 - Net radiative energy change)
ΔT_e = λ₀ × ΔF_net         (Eq. 4.9 - Temperature response)
λ₀ = 1/(4σT_e³) = T_e/(4F_L) (Eq. 4.10 - Climate sensitivity factor)</code></pre><p><strong>Outputs (Variables)</strong></p><ul><li><code>ΔF_net</code>: Net radiative forcing (W/m²)</li><li><code>ΔT_e</code>: Change in equilibrium temperature (K)</li><li><code>λ_0</code>: Climate sensitivity factor (K m²/W)</li><li><code>F_L</code>: Reference emitted longwave flux (W/m²)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>T_e</code>: Reference equilibrium temperature (K)</li><li><code>ΔF_S</code>: Change in absorbed solar flux (W/m²)</li><li><code>ΔF_L</code>: Change in emitted longwave flux (W/m²)</li></ul><p><strong>Constants</strong></p><ul><li><code>σ</code>: Stefan-Boltzmann constant = 5.671 × 10⁻⁸ W m⁻² K⁻⁴</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L242-L267">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.TOARadiativeForcing"><a class="docstring-binding" href="#GasChem.TOARadiativeForcing"><code>GasChem.TOARadiativeForcing</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">TOARadiativeForcing(; name=:TOARadiativeForcing)</code></pre><p>Implements the top of atmosphere radiative forcing based on Eq. 4.11 from Seinfeld &amp; Pandis.</p><pre><code class="language-julia hljs">F_net = S₀/4 × (1 - R_p) - F_L</code></pre><p>Note: Seinfeld &amp; Pandis define Eq. 4.11 as -F<em>net = S₀/4(1-R</em>p) - F<em>L, using the convention that -F</em>net represents net downward flux. Here we define F<em>net as net incoming flux directly, so positive F</em>net indicates the planet is gaining energy (warming).</p><p><strong>Outputs (Variables)</strong></p><ul><li><code>F_net</code>: Net radiative flux at TOA (W/m²) - positive = energy gain</li><li><code>F_S</code>: Absorbed solar flux (W/m²)</li></ul><p><strong>Inputs (Parameters)</strong></p><ul><li><code>S_0</code>: Solar constant = 1370 W/m² (can be varied)</li><li><code>R_p</code>: Planetary albedo ~ 0.3 (can be varied)</li><li><code>F_L</code>: Emitted longwave flux (W/m²) - input parameter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L305-L326">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.RadiationFundamentals"><a class="docstring-binding" href="#GasChem.RadiationFundamentals"><code>GasChem.RadiationFundamentals</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">RadiationFundamentals(; name=:RadiationFundamentals)</code></pre><p>Combined system implementing all radiation fundamentals equations from Seinfeld &amp; Pandis Chapter 4 (Eqs. 4.1-4.11).</p><p>This is a composed system that includes:</p><ul><li>PhotonEnergy: Energy-frequency-wavelength relations (Eq. 4.1)</li><li>BlackbodyRadiation: Planck&#39;s law (Eq. 4.2)</li><li>WienDisplacement: Peak emission wavelength (Eq. 4.3)</li><li>StefanBoltzmann: Total emissive power (Eq. 4.4)</li><li>PlanetaryEnergyBalance: Earth&#39;s energy balance (Eqs. 4.5-4.7)</li><li>ClimateSensitivity: Temperature response to forcing (Eqs. 4.8-4.10)</li><li>TOARadiativeForcing: Net flux at top of atmosphere (Eq. 4.11)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/a939398e0107daab63ba98943bd06fc21a897ebc/src/radiation_fundamentals.jl#L351-L366">source</a></section></details></article><h3 id="Physical-Constants"><a class="docs-heading-anchor" href="#Physical-Constants">Physical Constants</a><a id="Physical-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Constants" title="Permalink"></a></h3><p>The following fundamental constants are used throughout:</p><table><tr><th style="text-align: left">Constant</th><th style="text-align: left">Symbol</th><th style="text-align: left">Value</th><th style="text-align: left">Units</th></tr><tr><td style="text-align: left">Planck&#39;s constant</td><td style="text-align: left">h</td><td style="text-align: left">6.626 x 10^-34</td><td style="text-align: left">J s</td></tr><tr><td style="text-align: left">Speed of light</td><td style="text-align: left">c</td><td style="text-align: left">2.9979 x 10^8</td><td style="text-align: left">m/s</td></tr><tr><td style="text-align: left">Boltzmann constant</td><td style="text-align: left">k</td><td style="text-align: left">1.381 x 10^-23</td><td style="text-align: left">J/K</td></tr><tr><td style="text-align: left">Stefan-Boltzmann constant</td><td style="text-align: left">sigma</td><td style="text-align: left">5.671 x 10^-8</td><td style="text-align: left">W m^-2 K^-4</td></tr><tr><td style="text-align: left">Wien&#39;s displacement constant</td><td style="text-align: left">b</td><td style="text-align: left">2.897 x 10^-3</td><td style="text-align: left">m K</td></tr></table><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The radiation fundamentals are implemented as a set of ModelingToolkit.jl component systems. Each component encapsulates a specific physical relationship and can be used independently or combined into larger systems.</p><h3 id="Component-Systems"><a class="docs-heading-anchor" href="#Component-Systems">Component Systems</a><a id="Component-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Component-Systems" title="Permalink"></a></h3><p>The module provides seven individual component systems plus one composed system that combines them all:</p><ol><li><strong>PhotonEnergy</strong> - Photon energy-frequency-wavelength relations (Eq. 4.1)</li><li><strong>BlackbodyRadiation</strong> - Planck&#39;s law for spectral radiance (Eq. 4.2)</li><li><strong>WienDisplacement</strong> - Peak emission wavelength (Eq. 4.3)</li><li><strong>StefanBoltzmann</strong> - Total emissive power (Eq. 4.4)</li><li><strong>PlanetaryEnergyBalance</strong> - Earth&#39;s energy balance (Eqs. 4.5-4.7)</li><li><strong>ClimateSensitivity</strong> - Temperature response to forcing (Eqs. 4.8-4.10)</li><li><strong>TOARadiativeForcing</strong> - Net flux at top of atmosphere (Eq. 4.11)</li><li><strong>RadiationFundamentals</strong> - Composed system combining all components</li></ol><h3 id="PhotonEnergy-System"><a class="docs-heading-anchor" href="#PhotonEnergy-System">PhotonEnergy System</a><a id="PhotonEnergy-System-1"></a><a class="docs-heading-anchor-permalink" href="#PhotonEnergy-System" title="Permalink"></a></h3><p>Implements the photon energy equation (Eq. 4.1):</p><p class="math-container">\[\Delta\varepsilon = h\nu = \frac{hc}{\lambda}\]</p><p>where h is Planck&#39;s constant, nu is frequency, c is the speed of light, and lambda is wavelength.</p><pre><code class="language-julia hljs">using GasChem
using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities, NonlinearSolve
using ModelingToolkit: t
using GasChem: PhotonEnergy, BlackbodyRadiation, WienDisplacement, StefanBoltzmann
using GasChem: PlanetaryEnergyBalance, ClimateSensitivity, TOARadiativeForcing,
               RadiationFundamentals

# Helper to display variable/parameter tables from pre-compiled systems
function vars_table(sys)
    vars = ModelingToolkit.get_unknowns(sys)
    DataFrame(
        :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
        :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
        :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
    )
end
function params_table(sys)
    ps = ModelingToolkit.get_ps(sys)
    DataFrame(
        :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in ps],
        :Default =&gt; [ModelingToolkit.getdefault(p) for p in ps],
        :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in ps],
        :Description =&gt; [ModelingToolkit.getdescription(p) for p in ps]
    )
end

@named photon = PhotonEnergy()
vars_table(photon)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ν</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Frequency</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Δε</td><td style = "text-align: left;">m² kg s⁻²</td><td style = "text-align: left;">Photon energy</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(photon)</code></pre><div><div style = "float: left;"><span>3×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">λ</td><td style = "text-align: right;">5.0e-7</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Wavelength (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">h</td><td style = "text-align: right;">6.626e-34</td><td style = "text-align: left;">m² kg s⁻¹</td><td style = "text-align: left;">Planck&apos;s constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">c</td><td style = "text-align: right;">2.9979e8</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Speed of light</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(photon)</code></pre><p class="math-container">\[ \begin{align}
\nu\left( t \right) &amp;= \frac{c}{\lambda} \\
\mathtt{\Delta\varepsilon}\left( t \right) &amp;= h \nu\left( t \right)
\end{align}
 \]</p><h3 id="BlackbodyRadiation-System"><a class="docs-heading-anchor" href="#BlackbodyRadiation-System">BlackbodyRadiation System</a><a id="BlackbodyRadiation-System-1"></a><a class="docs-heading-anchor-permalink" href="#BlackbodyRadiation-System" title="Permalink"></a></h3><p>Implements Planck&#39;s blackbody radiation law (Eq. 4.2):</p><p class="math-container">\[F_B(\lambda) = \frac{2\pi c^2 h \lambda^{-5}}{\exp\left(\frac{ch}{k\lambda T}\right) - 1}\]</p><p>This equation gives the monochromatic emissive power of a blackbody at temperature T for a given wavelength lambda.</p><pre><code class="language-julia hljs">@named blackbody = BlackbodyRadiation()
vars_table(blackbody)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">F_B_λ</td><td style = "text-align: left;">m⁻¹ kg s⁻³</td><td style = "text-align: left;">Monochromatic blackbody emissive power</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(blackbody)</code></pre><div><div style = "float: left;"><span>6×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">π_val</td><td style = "text-align: right;">3.14159</td><td style = "text-align: left;"></td><td style = "text-align: left;">Pi (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">λ</td><td style = "text-align: right;">5.0e-7</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Wavelength (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">k_B</td><td style = "text-align: right;">1.381e-23</td><td style = "text-align: left;">m² kg s⁻² K⁻¹</td><td style = "text-align: left;">Boltzmann constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">h</td><td style = "text-align: right;">6.626e-34</td><td style = "text-align: left;">m² kg s⁻¹</td><td style = "text-align: left;">Planck&apos;s constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">T</td><td style = "text-align: right;">5800.0</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">c</td><td style = "text-align: right;">2.9979e8</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Speed of light</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(blackbody)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{F\_B\_\lambda}\left( t \right) &amp;= \frac{2 \left( \frac{1}{\lambda} \right)^{5} c^{2} h \mathtt{\pi\_val}}{-1 + e^{\frac{c h}{T \mathtt{k\_B} \lambda}}}
\end{align}
 \]</p><h3 id="WienDisplacement-System"><a class="docs-heading-anchor" href="#WienDisplacement-System">WienDisplacement System</a><a id="WienDisplacement-System-1"></a><a class="docs-heading-anchor-permalink" href="#WienDisplacement-System" title="Permalink"></a></h3><p>Implements Wien&#39;s displacement law (Eq. 4.3):</p><p class="math-container">\[\lambda_{max} = \frac{2.897 \times 10^{-3}}{T}\]</p><p>This gives the wavelength at which the blackbody emission spectrum peaks for a given temperature T.</p><pre><code class="language-julia hljs">@named wien = WienDisplacement()
vars_table(wien)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">λ_max</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Peak emission wavelength</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(wien)</code></pre><div><div style = "float: left;"><span>2×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">b</td><td style = "text-align: right;">0.002897</td><td style = "text-align: left;">m K</td><td style = "text-align: left;">Wien&apos;s displacement constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T</td><td style = "text-align: right;">5800.0</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature (input)</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(wien)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{\lambda\_max}\left( t \right) &amp;= \frac{b}{T}
\end{align}
 \]</p><h3 id="StefanBoltzmann-System"><a class="docs-heading-anchor" href="#StefanBoltzmann-System">StefanBoltzmann System</a><a id="StefanBoltzmann-System-1"></a><a class="docs-heading-anchor-permalink" href="#StefanBoltzmann-System" title="Permalink"></a></h3><p>Implements the Stefan-Boltzmann law (Eq. 4.4):</p><p class="math-container">\[F_B = \sigma T^4\]</p><p>The total emissive power of a blackbody integrated over all wavelengths.</p><pre><code class="language-julia hljs">@named sb = StefanBoltzmann()
vars_table(sb)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">F_B</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total blackbody emissive power</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(sb)</code></pre><div><div style = "float: left;"><span>2×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T</td><td style = "text-align: right;">255.0</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">σ</td><td style = "text-align: right;">5.671e-8</td><td style = "text-align: left;">kg s⁻³ K⁻⁴</td><td style = "text-align: left;">Stefan-Boltzmann constant</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(sb)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{F\_B}\left( t \right) &amp;= T^{4} \sigma
\end{align}
 \]</p><h3 id="PlanetaryEnergyBalance-System"><a class="docs-heading-anchor" href="#PlanetaryEnergyBalance-System">PlanetaryEnergyBalance System</a><a id="PlanetaryEnergyBalance-System-1"></a><a class="docs-heading-anchor-permalink" href="#PlanetaryEnergyBalance-System" title="Permalink"></a></h3><p>Implements the planetary energy balance equations (Eqs. 4.5-4.7):</p><p class="math-container">\[F_S = \frac{S_0}{4}(1 - R_p) \quad \text{(Eq. 4.5)}\]</p><p class="math-container">\[F_L = \sigma T_e^4 \quad \text{(Eq. 4.6)}\]</p><p class="math-container">\[T_e = \left[\frac{(1-R_p)S_0}{4\sigma}\right]^{1/4} \quad \text{(Eq. 4.7)}\]</p><p>At equilibrium, the absorbed solar flux equals the emitted longwave flux: F<em>S = F</em>L.</p><pre><code class="language-julia hljs">@named balance = PlanetaryEnergyBalance()
vars_table(balance)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">F_S</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">F_L</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted longwave flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">T_e</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Planetary equilibrium temperature</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(balance)</code></pre><div><div style = "float: left;"><span>3×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: right;">5.671e-8</td><td style = "text-align: left;">kg s⁻³ K⁻⁴</td><td style = "text-align: left;">Stefan-Boltzmann constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">S_0</td><td style = "text-align: right;">1370.0</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Solar constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_p</td><td style = "text-align: right;">0.3</td><td style = "text-align: left;"></td><td style = "text-align: left;">Planetary albedo (dimensionless)</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(balance)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{F\_S}\left( t \right) &amp;= \frac{1}{4} \left( 1 - \mathtt{R\_p} \right) \mathtt{S\_0} \\
\mathtt{F\_L}\left( t \right) &amp;= \left( \mathtt{T\_e}\left( t \right) \right)^{4} \sigma \\
\mathtt{F\_S}\left( t \right) &amp;= \mathtt{F\_L}\left( t \right)
\end{align}
 \]</p><h3 id="ClimateSensitivity-System"><a class="docs-heading-anchor" href="#ClimateSensitivity-System">ClimateSensitivity System</a><a id="ClimateSensitivity-System-1"></a><a class="docs-heading-anchor-permalink" href="#ClimateSensitivity-System" title="Permalink"></a></h3><p>Implements the climate sensitivity equations (Eqs. 4.8-4.10):</p><p class="math-container">\[\Delta F_{net} = \Delta F_S - \Delta F_L \quad \text{(Eq. 4.8)}\]</p><p class="math-container">\[\Delta T_e = \lambda_0 \Delta F_{net} \quad \text{(Eq. 4.9)}\]</p><p class="math-container">\[\lambda_0 = \frac{1}{4\sigma T_e^3} = \frac{T_e}{4F_L} \quad \text{(Eq. 4.10)}\]</p><pre><code class="language-julia hljs">@named sensitivity = ClimateSensitivity()
vars_table(sensitivity)</code></pre><div><div style = "float: left;"><span>4×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ΔF_net</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net radiative forcing</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">λ_0</td><td style = "text-align: left;">kg⁻¹ s³ K</td><td style = "text-align: left;">Climate sensitivity factor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">ΔT_e</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Change in equilibrium temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">F_L</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reference emitted longwave flux</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(sensitivity)</code></pre><div><div style = "float: left;"><span>4×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">σ</td><td style = "text-align: right;">5.671e-8</td><td style = "text-align: left;">kg s⁻³ K⁻⁴</td><td style = "text-align: left;">Stefan-Boltzmann constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">ΔF_S</td><td style = "text-align: right;">4.0</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Change in absorbed solar flux (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">ΔF_L</td><td style = "text-align: right;">0.0</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Change in emitted longwave flux (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">T_e</td><td style = "text-align: right;">255.0</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Reference equilibrium temperature (input)</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(sensitivity)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{{\Delta}F\_net}\left( t \right) &amp;=  - \mathtt{{\Delta}F\_L} + \mathtt{{\Delta}F\_S} \\
\mathtt{\lambda\_0}\left( t \right) &amp;= \frac{1}{4 \mathtt{T\_e}^{3} \sigma} \\
\mathtt{{\Delta}T\_e}\left( t \right) &amp;= \mathtt{{\Delta}F\_net}\left( t \right) \mathtt{\lambda\_0}\left( t \right) \\
\mathtt{F\_L}\left( t \right) &amp;= \mathtt{T\_e}^{4} \sigma
\end{align}
 \]</p><h3 id="TOARadiativeForcing-System"><a class="docs-heading-anchor" href="#TOARadiativeForcing-System">TOARadiativeForcing System</a><a id="TOARadiativeForcing-System-1"></a><a class="docs-heading-anchor-permalink" href="#TOARadiativeForcing-System" title="Permalink"></a></h3><p>Implements the top of atmosphere radiative forcing based on Eq. 4.11 from Seinfeld &amp; Pandis:</p><p class="math-container">\[F_{net} = \frac{S_0}{4}(1 - R_p) - F_L\]</p><p>Note: Seinfeld &amp; Pandis write Eq. 4.11 as <span>$-F_{net} = S_0/4(1-R_p) - F_L$</span>, using the convention that <span>$-F_{net}$</span> represents net downward flux. Here we define <span>$F_{net}$</span> as net incoming flux directly, so positive <span>$F_{net}$</span> indicates the planet is gaining energy (warming).</p><pre><code class="language-julia hljs">@named toa = TOARadiativeForcing()
vars_table(toa)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">F_S</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">F_net</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net radiative flux at TOA</td></tr></tbody></table></div><p><strong>Parameters:</strong></p><pre><code class="language-julia hljs">params_table(toa)</code></pre><div><div style = "float: left;"><span>3×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Default</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">S_0</td><td style = "text-align: right;">1370.0</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Solar constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">F_L</td><td style = "text-align: right;">239.75</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted longwave flux (input)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_p</td><td style = "text-align: right;">0.3</td><td style = "text-align: left;"></td><td style = "text-align: left;">Planetary albedo (dimensionless)</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(toa)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{F\_S}\left( t \right) &amp;= \frac{1}{4} \left( 1 - \mathtt{R\_p} \right) \mathtt{S\_0} \\
\mathtt{F\_net}\left( t \right) &amp;=  - \mathtt{F\_L} + \mathtt{F\_S}\left( t \right)
\end{align}
 \]</p><h3 id="RadiationFundamentals-Composed-System"><a class="docs-heading-anchor" href="#RadiationFundamentals-Composed-System">RadiationFundamentals Composed System</a><a id="RadiationFundamentals-Composed-System-1"></a><a class="docs-heading-anchor-permalink" href="#RadiationFundamentals-Composed-System" title="Permalink"></a></h3><p>The composed system combines all individual components:</p><pre><code class="language-julia hljs">@named radiation = RadiationFundamentals()

subsystems = ModelingToolkit.get_systems(radiation)
DataFrame(
    :Subsystem =&gt; [string(nameof(s)) for s in subsystems],
    :Equations =&gt; [&quot;Eq. 4.1&quot;, &quot;Eq. 4.2&quot;, &quot;Eq. 4.3&quot;, &quot;Eq. 4.4&quot;,
        &quot;Eqs. 4.5-4.7&quot;, &quot;Eqs. 4.8-4.10&quot;, &quot;Eq. 4.11&quot;]
)</code></pre><div><div style = "float: left;"><span>7×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Subsystem</th><th style = "text-align: left;">Equations</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">photon</td><td style = "text-align: left;">Eq. 4.1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">blackbody</td><td style = "text-align: left;">Eq. 4.2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">wien</td><td style = "text-align: left;">Eq. 4.3</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">stefan_boltzmann</td><td style = "text-align: left;">Eq. 4.4</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">energy_balance</td><td style = "text-align: left;">Eqs. 4.5-4.7</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">climate_sensitivity</td><td style = "text-align: left;">Eqs. 4.8-4.10</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">toa_forcing</td><td style = "text-align: left;">Eq. 4.11</td></tr></tbody></table></div><p><strong>State Variables (all subsystems):</strong></p><pre><code class="language-julia hljs">all_vars = vcat([ModelingToolkit.get_unknowns(s) for s in subsystems]...)
DataFrame(
    :Subsystem =&gt; vcat([[string(nameof(s)) for _ in ModelingToolkit.get_unknowns(s)]
                        for s in subsystems]...),
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in all_vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in all_vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in all_vars]
)</code></pre><div><div style = "float: left;"><span>14×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Subsystem</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">photon</td><td style = "text-align: left;">ν</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Frequency</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">photon</td><td style = "text-align: left;">Δε</td><td style = "text-align: left;">m² kg s⁻²</td><td style = "text-align: left;">Photon energy</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">blackbody</td><td style = "text-align: left;">F_B_λ</td><td style = "text-align: left;">m⁻¹ kg s⁻³</td><td style = "text-align: left;">Monochromatic blackbody emissive power</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">wien</td><td style = "text-align: left;">λ_max</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Peak emission wavelength</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">stefan_boltzmann</td><td style = "text-align: left;">F_B</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total blackbody emissive power</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">energy_balance</td><td style = "text-align: left;">F_S</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">energy_balance</td><td style = "text-align: left;">F_L</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted longwave flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">energy_balance</td><td style = "text-align: left;">T_e</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Planetary equilibrium temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">climate_sensitivity</td><td style = "text-align: left;">ΔF_net</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net radiative forcing</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">climate_sensitivity</td><td style = "text-align: left;">λ_0</td><td style = "text-align: left;">kg⁻¹ s³ K</td><td style = "text-align: left;">Climate sensitivity factor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">climate_sensitivity</td><td style = "text-align: left;">ΔT_e</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Change in equilibrium temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">climate_sensitivity</td><td style = "text-align: left;">F_L</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reference emitted longwave flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">toa_forcing</td><td style = "text-align: left;">F_S</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">toa_forcing</td><td style = "text-align: left;">F_net</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net radiative flux at TOA</td></tr></tbody></table></div><p><strong>Equations:</strong></p><pre><code class="language-julia hljs">equations(radiation)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{photon.\nu}\left( t \right) &amp;= \frac{\mathtt{photon.c}}{\mathtt{photon.\lambda}} \\
\mathtt{photon.\Delta\varepsilon}\left( t \right) &amp;= \mathtt{photon.h} \mathtt{photon.\nu}\left( t \right) \\
\mathtt{blackbody.F\_B\_\lambda}\left( t \right) &amp;= \frac{2 \left( \frac{1}{\mathtt{blackbody.\lambda}} \right)^{5} \mathtt{blackbody.c}^{2} \mathtt{blackbody.h} \mathtt{blackbody.\pi\_val}}{-1 + e^{\frac{\mathtt{blackbody.c} \mathtt{blackbody.h}}{\mathtt{blackbody.T} \mathtt{blackbody.k\_B} \mathtt{blackbody.\lambda}}}} \\
\mathtt{wien.\lambda\_max}\left( t \right) &amp;= \frac{\mathtt{wien.b}}{\mathtt{wien.T}} \\
\mathtt{stefan\_boltzmann.F\_B}\left( t \right) &amp;= \mathtt{stefan\_boltzmann.T}^{4} \mathtt{stefan\_boltzmann.\sigma} \\
\mathtt{energy\_balance.F\_S}\left( t \right) &amp;= \frac{1}{4} \left( 1 - \mathtt{energy\_balance.R\_p} \right) \mathtt{energy\_balance.S\_0} \\
\mathtt{energy\_balance.F\_L}\left( t \right) &amp;= \left( \mathtt{energy\_balance.T\_e}\left( t \right) \right)^{4} \mathtt{energy\_balance.\sigma} \\
\mathtt{energy\_balance.F\_S}\left( t \right) &amp;= \mathtt{energy\_balance.F\_L}\left( t \right) \\
\mathtt{climate\_sensitivity.{\Delta}F\_net}\left( t \right) &amp;=  - \mathtt{climate\_sensitivity.{\Delta}F\_L} + \mathtt{climate\_sensitivity.{\Delta}F\_S} \\
\mathtt{climate\_sensitivity.\lambda\_0}\left( t \right) &amp;= \frac{1}{4 \mathtt{climate\_sensitivity.T\_e}^{3} \mathtt{climate\_sensitivity.\sigma}} \\
\mathtt{climate\_sensitivity.{\Delta}T\_e}\left( t \right) &amp;= \mathtt{climate\_sensitivity.\lambda\_0}\left( t \right) \mathtt{climate\_sensitivity.{\Delta}F\_net}\left( t \right) \\
\mathtt{climate\_sensitivity.F\_L}\left( t \right) &amp;= \mathtt{climate\_sensitivity.T\_e}^{4} \mathtt{climate\_sensitivity.\sigma} \\
\mathtt{toa\_forcing.F\_S}\left( t \right) &amp;= \frac{1}{4} \left( 1 - \mathtt{toa\_forcing.R\_p} \right) \mathtt{toa\_forcing.S\_0} \\
\mathtt{toa\_forcing.F\_net}\left( t \right) &amp;=  - \mathtt{toa\_forcing.F\_L} + \mathtt{toa\_forcing.F\_S}\left( t \right)
\end{align}
 \]</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>This section demonstrates the physics captured by the radiation fundamentals equations through numerical examples and visualizations that reproduce key results from Seinfeld and Pandis (2006).</p><h3 id="Blackbody-Radiation-Spectra-(cf.-Figures-4.2-4.3)"><a class="docs-heading-anchor" href="#Blackbody-Radiation-Spectra-(cf.-Figures-4.2-4.3)">Blackbody Radiation Spectra (cf. Figures 4.2-4.3)</a><a id="Blackbody-Radiation-Spectra-(cf.-Figures-4.2-4.3)-1"></a><a class="docs-heading-anchor-permalink" href="#Blackbody-Radiation-Spectra-(cf.-Figures-4.2-4.3)" title="Permalink"></a></h3><p>The Planck function describes the spectral distribution of radiation emitted by a blackbody. The following plot shows blackbody spectra at different temperatures, demonstrating how the peak wavelength shifts according to Wien&#39;s law and total power increases with temperature according to the Stefan-Boltzmann law.</p><pre><code class="language-julia hljs">using Plots

# Use the BlackbodyRadiation MTK component to compute spectra
@named bb_analysis = BlackbodyRadiation()
compiled_bb = mtkcompile(bb_analysis)

# Also use WienDisplacement for peak wavelengths
@named wien_analysis = WienDisplacement()
compiled_wien_analysis = mtkcompile(wien_analysis)

# Wavelength range (in meters)
lambda_range = 10 .^ range(-7, -4, length = 500)  # 100 nm to 100 um

# Temperatures to plot
temperatures = [5800, 1000, 500, 300]
colors = [:orange, :red, :darkred, :blue]
labels = [&quot;Sun (5800 K)&quot;, &quot;1000 K&quot;, &quot;500 K&quot;, &quot;Earth (300 K)&quot;]

p1 = plot(xlabel = &quot;Wavelength (m)&quot;, ylabel = &quot;Spectral Radiance (W/m³)&quot;,
    title = &quot;Blackbody Radiation Spectra (Planck&#39;s Law, Eq. 4.2)&quot;,
    xscale = :log10, yscale = :log10,
    xlims = (1e-7, 1e-4), ylims = (1e0, 1e14),
    legend = :topright, size = (700, 500))

bb_prob = NonlinearProblem(compiled_bb, Dict(); build_initializeprob = false)
wien_prob = NonlinearProblem(compiled_wien_analysis, Dict(); build_initializeprob = false)

for (T, col, lab) in zip(temperatures, colors, labels)
    # Compute spectrum using BlackbodyRadiation component
    F = Float64[]
    for λ in lambda_range
        prob_i = remake(bb_prob, p = [compiled_bb.T =&gt; Float64(T), compiled_bb.λ =&gt; λ])
        sol_i = solve(prob_i)
        push!(F, sol_i[compiled_bb.F_B_λ])
    end
    plot!(p1, lambda_range, F, label = lab, color = col, linewidth = 2)

    # Mark peak wavelength using WienDisplacement component
    wien_prob_i = remake(wien_prob, p = [compiled_wien_analysis.T =&gt; Float64(T)])
    wien_sol = solve(wien_prob_i)
    lambda_max = wien_sol[compiled_wien_analysis.λ_max]

    bb_peak_prob = remake(bb_prob, p = [
        compiled_bb.T =&gt; Float64(T), compiled_bb.λ =&gt; lambda_max])
    bb_peak_sol = solve(bb_peak_prob)
    F_max = bb_peak_sol[compiled_bb.F_B_λ]
    scatter!(p1, [lambda_max], [F_max], color = col, markersize = 6, label = &quot;&quot;)
end

# Add Wien&#39;s displacement law annotation
annotate!(p1, 5e-7, 1e12, text(&quot;Wien: lambda_max = 2897/T&quot;, 8, :left))

savefig(p1, &quot;blackbody_spectra.svg&quot;)
p1</code></pre><img src="92be8674.svg" alt="Example block output"/><p><strong>Figure 1</strong>: Blackbody radiation spectra at different temperatures (cf. S&amp;P Figures 4.2-4.3). The dots mark the peak wavelength given by Wien&#39;s displacement law (Eq. 4.3). The Sun at 5800 K peaks in the visible range (~500 nm), while Earth at ~300 K peaks in the thermal infrared (~10 um). Note: These are ideal blackbody curves; Figure 4.2 in S&amp;P also shows the observed solar spectrum with Fraunhofer absorption lines.</p><h3 id="Spectral-Irradiance-of-a-Blackbody-at-300-K-(cf.-Figure-4.3)"><a class="docs-heading-anchor" href="#Spectral-Irradiance-of-a-Blackbody-at-300-K-(cf.-Figure-4.3)">Spectral Irradiance of a Blackbody at 300 K (cf. Figure 4.3)</a><a id="Spectral-Irradiance-of-a-Blackbody-at-300-K-(cf.-Figure-4.3)-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Irradiance-of-a-Blackbody-at-300-K-(cf.-Figure-4.3)" title="Permalink"></a></h3><p>Figure 4.3 in S&amp;P shows the spectral irradiance of a blackbody at 300 K, representative of Earth&#39;s thermal emission, plotted with linear axes and wavelength in micrometers.</p><pre><code class="language-julia hljs"># Reproduce S&amp;P Figure 4.3: 300 K blackbody spectrum (linear axes, wavelength in μm)
lambda_um_range = range(1.0, 70.0, length = 500)  # 1-70 μm

F_300K = Float64[]
for λ_um in lambda_um_range
    λ_m = λ_um * 1e-6  # Convert μm to m
    prob_i = remake(bb_prob, p = [compiled_bb.T =&gt; 300.0, compiled_bb.λ =&gt; λ_m])
    sol_i = solve(prob_i)
    # Convert W/m³ to W m⁻² μm⁻¹ by multiplying by 1e-6 (dλ_m/dλ_μm)
    push!(F_300K, sol_i[compiled_bb.F_B_λ] * 1e-6)
end

p1b = plot(lambda_um_range, F_300K,
    xlabel = &quot;Wavelength, μm&quot;,
    ylabel = &quot;F_B, W m⁻² μm⁻¹&quot;,
    title = &quot;Spectral irradiance of a blackbody at 300 K (cf. S&amp;P Figure 4.3)&quot;,
    label = &quot;300 K Blackbody&quot;,
    linewidth = 2, color = :black,
    xlims = (0, 70), ylims = (0, maximum(F_300K) * 1.1),
    legend = :topright, size = (600, 400))

savefig(p1b, &quot;blackbody_300K.svg&quot;)
p1b</code></pre><img src="bd643d63.svg" alt="Example block output"/><p><strong>Figure 1b</strong>: Spectral irradiance of a blackbody at 300 K (cf. S&amp;P Figure 4.3). The peak emission occurs at approximately 10 μm in the thermal infrared, as predicted by Wien&#39;s displacement law. This spectrum is representative of the longwave radiation emitted by Earth&#39;s surface.</p><h3 id="Wien&#39;s-Displacement-Law-Demonstration-(Eq.-4.3)"><a class="docs-heading-anchor" href="#Wien&#39;s-Displacement-Law-Demonstration-(Eq.-4.3)">Wien&#39;s Displacement Law Demonstration (Eq. 4.3)</a><a id="Wien&#39;s-Displacement-Law-Demonstration-(Eq.-4.3)-1"></a><a class="docs-heading-anchor-permalink" href="#Wien&#39;s-Displacement-Law-Demonstration-(Eq.-4.3)" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Demonstrate Wien&#39;s displacement law
@named wien_sys = WienDisplacement()
compiled_wien = mtkcompile(wien_sys)

temperatures_K = [5800, 3000, 1000, 500, 300, 255]
peak_wavelengths_nm = Float64[]

for T in temperatures_K
    prob = NonlinearProblem(compiled_wien, Dict(); build_initializeprob = false)
    prob = remake(prob, p = [compiled_wien.T =&gt; T])
    sol = solve(prob)
    push!(peak_wavelengths_nm, sol[compiled_wien.λ_max] * 1e9)  # Convert to nm
end

DataFrame(
    :Temperature_K =&gt; temperatures_K,
    :Peak_Wavelength_nm =&gt; round.(peak_wavelengths_nm, digits = 1),
    :Spectral_Region =&gt; [
        &quot;Visible (yellow)&quot;, &quot;Near-IR&quot;, &quot;Near-IR&quot;, &quot;Mid-IR&quot;, &quot;Thermal IR&quot;, &quot;Thermal IR&quot;]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Temperature_K</th><th style = "text-align: left;">Peak_Wavelength_nm</th><th style = "text-align: left;">Spectral_Region</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">5800</td><td style = "text-align: right;">499.5</td><td style = "text-align: left;">Visible (yellow)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">3000</td><td style = "text-align: right;">965.7</td><td style = "text-align: left;">Near-IR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">1000</td><td style = "text-align: right;">2897.0</td><td style = "text-align: left;">Near-IR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">500</td><td style = "text-align: right;">5794.0</td><td style = "text-align: left;">Mid-IR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">300</td><td style = "text-align: right;">9656.7</td><td style = "text-align: left;">Thermal IR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">255</td><td style = "text-align: right;">11360.8</td><td style = "text-align: left;">Thermal IR</td></tr></tbody></table></div><h3 id="Planetary-Energy-Balance-(Eqs.-4.5-4.7)"><a class="docs-heading-anchor" href="#Planetary-Energy-Balance-(Eqs.-4.5-4.7)">Planetary Energy Balance (Eqs. 4.5-4.7)</a><a id="Planetary-Energy-Balance-(Eqs.-4.5-4.7)-1"></a><a class="docs-heading-anchor-permalink" href="#Planetary-Energy-Balance-(Eqs.-4.5-4.7)" title="Permalink"></a></h3><p>The equilibrium temperature of Earth can be calculated from the balance between absorbed solar radiation and emitted thermal radiation.</p><pre><code class="language-julia hljs">@named energy_sys = PlanetaryEnergyBalance()
compiled_energy = mtkcompile(energy_sys)

# Solve with default parameters (S_0 = 1370 W/m², R_p = 0.3)
prob = NonlinearProblem(compiled_energy, Dict(compiled_energy.T_e =&gt; 250.0); build_initializeprob = false)
sol = solve(prob)

println(&quot;Planetary Energy Balance Results:&quot;)
println(&quot;================================&quot;)
println(&quot;Solar constant (S_0): 1370 W/m²&quot;)
println(&quot;Planetary albedo (R_p): 0.3&quot;)
println(&quot;Absorbed solar flux (F_S): &quot;, round(sol[compiled_energy.F_S], digits = 2), &quot; W/m²&quot;)
println(&quot;Emitted longwave flux (F_L): &quot;, round(sol[compiled_energy.F_L], digits = 2), &quot; W/m²&quot;)
println(&quot;Equilibrium temperature (T_e): &quot;, round(sol[compiled_energy.T_e], digits = 1), &quot; K&quot;)
println(&quot;Equilibrium temperature (T_e): &quot;, round(sol[compiled_energy.T_e] - 273.15, digits = 1), &quot; °C&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Planetary Energy Balance Results:
================================
Solar constant (S_0): 1370 W/m²
Planetary albedo (R_p): 0.3
Absorbed solar flux (F_S): 239.75 W/m²
Emitted longwave flux (F_L): 239.75 W/m²
Equilibrium temperature (T_e): 255.0 K
Equilibrium temperature (T_e): -18.2 °C</code></pre><p>The calculated equilibrium temperature of ~255 K (-18 C) is significantly colder than Earth&#39;s actual average surface temperature of ~288 K (15 C). This 33 K difference is due to the greenhouse effect, which is not included in this simple energy balance model.</p><h3 id="Effect-of-Albedo-on-Equilibrium-Temperature"><a class="docs-heading-anchor" href="#Effect-of-Albedo-on-Equilibrium-Temperature">Effect of Albedo on Equilibrium Temperature</a><a id="Effect-of-Albedo-on-Equilibrium-Temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Effect-of-Albedo-on-Equilibrium-Temperature" title="Permalink"></a></h3><pre><code class="language-julia hljs">albedos = 0.0:0.05:0.8
T_equilibrium = Float64[]

for R_p in albedos
    prob = NonlinearProblem(compiled_energy, Dict(compiled_energy.T_e =&gt; 250.0); build_initializeprob = false)
    prob = remake(prob, p = [compiled_energy.R_p =&gt; R_p])
    sol = solve(prob)
    push!(T_equilibrium, sol[compiled_energy.T_e])
end

p2 = plot(albedos, T_equilibrium,
    xlabel = &quot;Planetary Albedo (R_p)&quot;,
    ylabel = &quot;Equilibrium Temperature (K)&quot;,
    title = &quot;Effect of Albedo on Planetary Temperature (Eq. 4.7)&quot;,
    label = &quot;T_e = [(1-R_p)S_0/(4σ)]^(1/4)&quot;,
    linewidth = 2, color = :blue,
    size = (600, 400))

# Mark Earth&#39;s approximate values
scatter!(p2, [0.3], [255.0], color = :red, markersize = 8, label = &quot;Earth (R_p ≈ 0.3)&quot;)

# Add horizontal line for freezing point
hline!(p2, [273.15], linestyle = :dash, color = :gray, label = &quot;Freezing (273 K)&quot;)

savefig(p2, &quot;albedo_temperature.svg&quot;)
p2</code></pre><img src="015b147a.svg" alt="Example block output"/><p><strong>Figure 2</strong>: Equilibrium temperature as a function of planetary albedo. Higher albedo reflects more solar radiation, resulting in a colder equilibrium temperature. Earth with an albedo of ~0.3 has an equilibrium temperature of ~255 K.</p><h3 id="Climate-Sensitivity-Analysis-(Eqs.-4.8-4.10)"><a class="docs-heading-anchor" href="#Climate-Sensitivity-Analysis-(Eqs.-4.8-4.10)">Climate Sensitivity Analysis (Eqs. 4.8-4.10)</a><a id="Climate-Sensitivity-Analysis-(Eqs.-4.8-4.10)-1"></a><a class="docs-heading-anchor-permalink" href="#Climate-Sensitivity-Analysis-(Eqs.-4.8-4.10)" title="Permalink"></a></h3><p>The climate sensitivity parameter lambda_0 describes how the equilibrium temperature changes in response to radiative forcing.</p><pre><code class="language-julia hljs">@named climate_sys = ClimateSensitivity()
compiled_climate = mtkcompile(climate_sys)

# Calculate climate sensitivity at Earth&#39;s equilibrium temperature
prob = NonlinearProblem(compiled_climate, Dict(); build_initializeprob = false)
sol = solve(prob)

lambda_0 = sol[compiled_climate.λ_0]
println(&quot;Climate Sensitivity Analysis (no-feedback case):&quot;)
println(&quot;================================================&quot;)
println(&quot;Reference temperature (T_e): 255 K&quot;)
println(&quot;Climate sensitivity (λ_0): &quot;, round(lambda_0, digits = 4), &quot; K/(W/m²)&quot;)
println(&quot;&quot;)
println(&quot;For a radiative forcing of 4 W/m² (typical CO2 doubling):&quot;)
println(&quot;Temperature change (ΔT_e): &quot;, round(sol[compiled_climate.ΔT_e], digits = 2), &quot; K&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Climate Sensitivity Analysis (no-feedback case):
================================================
Reference temperature (T_e): 255 K
Climate sensitivity (λ_0): 0.2659 K/(W/m²)

For a radiative forcing of 4 W/m² (typical CO2 doubling):
Temperature change (ΔT_e): 1.06 K</code></pre><h3 id="Temperature-Response-to-Radiative-Forcing"><a class="docs-heading-anchor" href="#Temperature-Response-to-Radiative-Forcing">Temperature Response to Radiative Forcing</a><a id="Temperature-Response-to-Radiative-Forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Response-to-Radiative-Forcing" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Calculate temperature response for different forcing levels
forcings = 0:0.5:10  # W/m²
delta_T = Float64[]

for ΔF in forcings
    prob = NonlinearProblem(compiled_climate, Dict(); build_initializeprob = false)
    prob = remake(prob, p = [compiled_climate.ΔF_S =&gt; ΔF])
    sol = solve(prob)
    push!(delta_T, sol[compiled_climate.ΔT_e])
end

p3 = plot(forcings, delta_T,
    xlabel = &quot;Radiative Forcing (W/m²)&quot;,
    ylabel = &quot;Temperature Change (K)&quot;,
    title = &quot;Climate Sensitivity (Eq. 4.9): ΔT = λ₀ × ΔF&quot;,
    label = &quot;No-feedback response&quot;,
    linewidth = 2, color = :red,
    size = (600, 400))

# Mark typical CO2 doubling forcing
vline!(p3, [4.0], linestyle = :dash, color = :gray, label = &quot;CO₂ doubling (~4 W/m²)&quot;)
scatter!(p3, [4.0], [4.0 * lambda_0], color = :blue, markersize = 8, label = &quot;ΔT ≈ 1.1 K&quot;)

savefig(p3, &quot;climate_sensitivity.svg&quot;)
p3</code></pre><img src="6e9e47f9.svg" alt="Example block output"/><p><strong>Figure 3</strong>: Temperature change as a function of radiative forcing for the no-feedback case. The climate sensitivity lambda<em>0 = 1/(4<em>sigma</em>T</em>e^3) = 0.266 K/(W/m^2) at T<em>e = 255 K (S&amp;P approximate this as ~0.3). For a CO2 doubling forcing of ~4.6 W/m^2 (S&amp;P p. 105), this gives ΔT</em>e ≈ 1.2 K with the exact lambda_0 (S&amp;P report ~1.4 K using the rounded value). Note: Real climate sensitivity is higher due to positive feedbacks (water vapor, ice-albedo, etc.).</p><h3 id="Stefan-Boltzmann-Law:-Total-Emissive-Power"><a class="docs-heading-anchor" href="#Stefan-Boltzmann-Law:-Total-Emissive-Power">Stefan-Boltzmann Law: Total Emissive Power</a><a id="Stefan-Boltzmann-Law:-Total-Emissive-Power-1"></a><a class="docs-heading-anchor-permalink" href="#Stefan-Boltzmann-Law:-Total-Emissive-Power" title="Permalink"></a></h3><pre><code class="language-julia hljs">@named sb_sys = StefanBoltzmann()
compiled_sb = mtkcompile(sb_sys)

temperatures = 200:10:400  # K
emissive_power = Float64[]

for T in temperatures
    prob = NonlinearProblem(compiled_sb, Dict(); build_initializeprob = false)
    prob = remake(prob, p = [compiled_sb.T =&gt; T])
    sol = solve(prob)
    push!(emissive_power, sol[compiled_sb.F_B])
end

p4 = plot(temperatures, emissive_power,
    xlabel = &quot;Temperature (K)&quot;,
    ylabel = &quot;Total Emissive Power (W/m²)&quot;,
    title = &quot;Stefan-Boltzmann Law (Eq. 4.4): F_B = σT⁴&quot;,
    label = &quot;Blackbody emission&quot;,
    linewidth = 2, color = :orange,
    size = (600, 400))

# Mark key temperatures using the StefanBoltzmann component
sb_prob = NonlinearProblem(compiled_sb, Dict(); build_initializeprob = false)

sb_eq_prob = remake(sb_prob, p = [compiled_sb.T =&gt; 255.0])
sb_eq_sol = solve(sb_eq_prob)
F_eq = sb_eq_sol[compiled_sb.F_B]

sb_surf_prob = remake(sb_prob, p = [compiled_sb.T =&gt; 288.0])
sb_surf_sol = solve(sb_surf_prob)
F_surf = sb_surf_sol[compiled_sb.F_B]

scatter!(p4, [255], [F_eq], color = :blue, markersize = 8, label = &quot;Earth eq. (255 K)&quot;)
scatter!(p4, [288], [F_surf], color = :red, markersize = 8, label = &quot;Earth surface (288 K)&quot;)

savefig(p4, &quot;stefan_boltzmann.svg&quot;)
p4</code></pre><img src="03405e52.svg" alt="Example block output"/><p><strong>Figure 4</strong>: Total blackbody emissive power as a function of temperature. The T^4 dependence means that small temperature increases lead to significantly higher emission, which acts as a stabilizing feedback in the climate system.</p><h3 id="Photon-Energy-Across-the-Electromagnetic-Spectrum"><a class="docs-heading-anchor" href="#Photon-Energy-Across-the-Electromagnetic-Spectrum">Photon Energy Across the Electromagnetic Spectrum</a><a id="Photon-Energy-Across-the-Electromagnetic-Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Photon-Energy-Across-the-Electromagnetic-Spectrum" title="Permalink"></a></h3><pre><code class="language-julia hljs">@named photon_sys = PhotonEnergy()
compiled_photon = mtkcompile(photon_sys)

# Wavelengths spanning UV to thermal IR
wavelengths_m = [1e-8, 1e-7, 4e-7, 5e-7, 7e-7, 1e-6, 1e-5, 1e-4]
wavelength_labels = [&quot;X-ray (10 nm)&quot;, &quot;UV (100 nm)&quot;, &quot;Violet (400 nm)&quot;, &quot;Green (500 nm)&quot;,
    &quot;Red (700 nm)&quot;, &quot;Near-IR (1 μm)&quot;, &quot;Thermal IR (10 μm)&quot;, &quot;Far-IR (100 μm)&quot;]

energies_eV = Float64[]
frequencies_Hz = Float64[]

for λ in wavelengths_m
    prob = NonlinearProblem(compiled_photon, Dict(); build_initializeprob = false)
    prob = remake(prob, p = [compiled_photon.λ =&gt; λ])
    sol = solve(prob)
    push!(energies_eV, sol[compiled_photon.Δε] / 1.602e-19)  # Convert J to eV
    push!(frequencies_Hz, sol[compiled_photon.ν])
end

DataFrame(
    :Wavelength =&gt; wavelength_labels,
    :Wavelength_m =&gt; wavelengths_m,
    :Frequency_Hz =&gt; frequencies_Hz,
    :Energy_eV =&gt; round.(energies_eV, digits = 4)
)</code></pre><div><div style = "float: left;"><span>8×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Wavelength</th><th style = "text-align: left;">Wavelength_m</th><th style = "text-align: left;">Frequency_Hz</th><th style = "text-align: left;">Energy_eV</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">X-ray (10 nm)</td><td style = "text-align: right;">1.0e-8</td><td style = "text-align: right;">2.9979e16</td><td style = "text-align: right;">123.996</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">UV (100 nm)</td><td style = "text-align: right;">1.0e-7</td><td style = "text-align: right;">2.9979e15</td><td style = "text-align: right;">12.3996</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Violet (400 nm)</td><td style = "text-align: right;">4.0e-7</td><td style = "text-align: right;">7.49475e14</td><td style = "text-align: right;">3.0999</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Green (500 nm)</td><td style = "text-align: right;">5.0e-7</td><td style = "text-align: right;">5.9958e14</td><td style = "text-align: right;">2.4799</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">Red (700 nm)</td><td style = "text-align: right;">7.0e-7</td><td style = "text-align: right;">4.28271e14</td><td style = "text-align: right;">1.7714</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">Near-IR (1 μm)</td><td style = "text-align: right;">1.0e-6</td><td style = "text-align: right;">2.9979e14</td><td style = "text-align: right;">1.24</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">Thermal IR (10 μm)</td><td style = "text-align: right;">1.0e-5</td><td style = "text-align: right;">2.9979e13</td><td style = "text-align: right;">0.124</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">Far-IR (100 μm)</td><td style = "text-align: right;">0.0001</td><td style = "text-align: right;">2.9979e12</td><td style = "text-align: right;">0.0124</td></tr></tbody></table></div><p>This table demonstrates the inverse relationship between wavelength and photon energy (Eq. 4.1). UV and visible photons have sufficient energy to break chemical bonds and drive photochemistry, while infrared photons primarily contribute to thermal processes.</p><h3 id="Photon-Energy-in-kJ/mol-for-Atmospheric-Photochemistry-(cf.-S-and-P-p.-114)"><a class="docs-heading-anchor" href="#Photon-Energy-in-kJ/mol-for-Atmospheric-Photochemistry-(cf.-S-and-P-p.-114)">Photon Energy in kJ/mol for Atmospheric Photochemistry (cf. S&amp;P p. 114)</a><a id="Photon-Energy-in-kJ/mol-for-Atmospheric-Photochemistry-(cf.-S-and-P-p.-114)-1"></a><a class="docs-heading-anchor-permalink" href="#Photon-Energy-in-kJ/mol-for-Atmospheric-Photochemistry-(cf.-S-and-P-p.-114)" title="Permalink"></a></h3><p>In atmospheric photochemistry, photon energies are often expressed per mole using Avogadro&#39;s number: ε = N_A × hc/λ (S&amp;P Eq. 4.34). For wavelength λ in nm, this gives ε = 1.19625 × 10⁵ / λ kJ mol⁻¹ (Eq. 4.35). The following table reproduces the wavelength-energy ranges from S&amp;P Table on p. 114.</p><pre><code class="language-julia hljs"># Reproduce S&amp;P p.114 wavelength-energy table using Eq. 4.34: ε = N_A * hc/λ
N_A = 6.022e23  # Avogadro&#39;s number, mol⁻¹

# Representative wavelengths from S&amp;P p. 114 table
vis_wavelengths_nm = [700, 620, 580, 530, 470, 420]
vis_labels = [&quot;Red&quot;, &quot;Orange&quot;, &quot;Yellow&quot;, &quot;Green&quot;, &quot;Blue&quot;, &quot;Violet&quot;]

uv_wavelengths_nm = [300, 125]
uv_labels = [&quot;Near ultraviolet (center)&quot;, &quot;Vacuum ultraviolet (center)&quot;]

all_labels = vcat(vis_labels, uv_labels)
all_wavelengths_nm = vcat(vis_wavelengths_nm, uv_wavelengths_nm)

energies_kJ_mol = Float64[]
for λ_nm in all_wavelengths_nm
    λ_m = λ_nm * 1e-9
    prob_e = NonlinearProblem(compiled_photon, Dict(); build_initializeprob = false)
    prob_e = remake(prob_e, p = [compiled_photon.λ =&gt; λ_m])
    sol_e = solve(prob_e)
    ε_per_mol = sol_e[compiled_photon.Δε] * N_A / 1000  # J/mol → kJ/mol
    push!(energies_kJ_mol, ε_per_mol)
end

DataFrame(
    :Region =&gt; all_labels,
    :Wavelength_nm =&gt; all_wavelengths_nm,
    :Energy_kJ_per_mol =&gt; round.(energies_kJ_mol, digits = 0)
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Region</th><th style = "text-align: left;">Wavelength_nm</th><th style = "text-align: left;">Energy_kJ_per_mol</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Red</td><td style = "text-align: right;">700</td><td style = "text-align: right;">171.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Orange</td><td style = "text-align: right;">620</td><td style = "text-align: right;">193.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Yellow</td><td style = "text-align: right;">580</td><td style = "text-align: right;">206.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Green</td><td style = "text-align: right;">530</td><td style = "text-align: right;">226.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">Blue</td><td style = "text-align: right;">470</td><td style = "text-align: right;">255.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">Violet</td><td style = "text-align: right;">420</td><td style = "text-align: right;">285.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">Near ultraviolet (center)</td><td style = "text-align: right;">300</td><td style = "text-align: right;">399.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">Vacuum ultraviolet (center)</td><td style = "text-align: right;">125</td><td style = "text-align: right;">957.0</td></tr></tbody></table></div><p>The visible range (400-700 nm) corresponds to photon energies of approximately 170-300 kJ/mol, which are comparable to chemical bond energies. For example, the O-O bond in ozone has a dissociation energy of about 105 kJ/mol, and the O-NO bond in NO₂ has a dissociation energy of about 300 kJ/mol (corresponding to a wavelength of about 400 nm). This explains why visible and UV photons can drive atmospheric photodissociation reactions.</p><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>The radiation fundamentals equations from Seinfeld and Pandis Chapter 4 provide the physical basis for understanding:</p><ol><li><strong>Quantum nature of light</strong>: Photon energy is proportional to frequency (Eq. 4.1)</li><li><strong>Thermal emission spectra</strong>: Planck&#39;s law describes spectral distribution (Eq. 4.2)</li><li><strong>Peak emission wavelength</strong>: Wien&#39;s law relates peak wavelength to temperature (Eq. 4.3)</li><li><strong>Total thermal power</strong>: Stefan-Boltzmann law gives T^4 dependence (Eq. 4.4)</li><li><strong>Planetary temperature</strong>: Energy balance determines equilibrium temperature (Eqs. 4.5-4.7)</li><li><strong>Climate response</strong>: Sensitivity relates temperature change to forcing (Eqs. 4.8-4.10)</li><li><strong>Radiative imbalance</strong>: TOA flux determines warming or cooling tendency (Eq. 4.11)</li></ol><p>The ModelingToolkit.jl implementation allows these equations to be easily combined, modified, and solved for various atmospheric and climate applications.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../combined_system/">« Combined System</a><a class="docs-footer-nextpage" href="../StratosphericChemistry/">Stratospheric Chemistry »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 6 February 2026 17:56">Friday 6 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
