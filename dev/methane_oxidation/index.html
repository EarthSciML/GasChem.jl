<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methane Oxidation · GasChem.jl</title><meta name="title" content="Methane Oxidation · GasChem.jl"/><meta property="og:title" content="Methane Oxidation · GasChem.jl"/><meta property="twitter:title" content="Methane Oxidation · GasChem.jl"/><meta name="description" content="Documentation for GasChem.jl."/><meta property="og:description" content="Documentation for GasChem.jl."/><meta property="twitter:description" content="Documentation for GasChem.jl."/><meta property="og:url" content="https://gaschem.earthsci.dev/methane_oxidation/"/><meta property="twitter:url" content="https://gaschem.earthsci.dev/methane_oxidation/"/><link rel="canonical" href="https://gaschem.earthsci.dev/methane_oxidation/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChem.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../AtmosphericLifetime/">Atmospheric Lifetime</a></li><li><a class="tocitem" href="../superfast/">SuperFast</a></li><li><span class="tocitem">GEOS-Chem</span><ul><li><a class="tocitem" href="../geoschem/overview/">Overview</a></li><li><a class="tocitem" href="../geoschem/states/">State Variables</a></li><li><a class="tocitem" href="../geoschem/params/">Parameters</a></li></ul></li><li><span class="tocitem">Seinfeld &amp; Pandis Ch. 6</span><ul><li><a class="tocitem" href="../oh_production/">OH Production</a></li><li><a class="tocitem" href="../nox_photochemistry/">NOx Photochemistry</a></li><li><a class="tocitem" href="../co_oxidation/">CO Oxidation</a></li><li class="is-active"><a class="tocitem" href>Methane Oxidation</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../combined_system/">Combined System</a></li></ul></li><li><a class="tocitem" href="../radiation_fundamentals/">Radiation Fundamentals</a></li><li><a class="tocitem" href="../StratosphericChemistry/">Stratospheric Chemistry</a></li><li><a class="tocitem" href="../climate_forcing/">Climate Forcing</a></li><li><a class="tocitem" href="../composing_models/">Composing models</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Seinfeld &amp; Pandis Ch. 6</a></li><li class="is-active"><a href>Methane Oxidation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Methane Oxidation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl/blob/main/docs/src/methane_oxidation.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="methane_oxidation"><a class="docs-heading-anchor" href="#methane_oxidation">Methane Oxidation</a><a id="methane_oxidation-1"></a><a class="docs-heading-anchor-permalink" href="#methane_oxidation" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Methane (CH4) is the most abundant hydrocarbon in the atmosphere (~1.8 ppm). Its oxidation is the archetypal VOC oxidation mechanism, proceeding through several intermediates:</p><pre><code class="nohighlight hljs">CH4 -&gt; CH3O2 -&gt; CH3O -&gt; HCHO -&gt; HCO -&gt; CO -&gt; CO2</code></pre><p>Each step can produce ozone when NOx is present through peroxy + NO reactions. At high NOx, complete CH4 oxidation can produce 3-5 O3 molecules.</p><p>Two components are provided:</p><ul><li><code>MethaneOxidation</code>: Algebraic system computing individual reaction rates and diagnostics from Table 6.1</li><li><code>MethaneOxidationODE</code>: Full ODE system for time evolution of all species</li></ul><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition. John Wiley &amp; Sons. Section 6.4, Table 6.1, pp. 219-227.</p><article><details class="docstring" open="true"><summary id="GasChem.MethaneOxidation"><a class="docstring-binding" href="#GasChem.MethaneOxidation"><code>GasChem.MethaneOxidation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MethaneOxidation(; name)</code></pre><p>ModelingToolkit System implementing reaction rate diagnostics for the methane oxidation mechanism from Table 6.1 of Seinfeld &amp; Pandis Chapter 6.</p><p>This system computes individual reaction rates and diagnostic production/loss terms.</p><p><strong>Species (Input Variables)</strong></p><ul><li>CH4, CH3, CH3O2, CH3O, CH3OOH: Methane chain species [m⁻³]</li><li>HCHO, HCO, CO: Formaldehyde and products [m⁻³]</li><li>OH, HO2, H: HOx species [m⁻³]</li><li>NO, NO2, O, O2, O3: NOx and oxygen species [m⁻³]</li><li>M: Total air density [m⁻³]</li></ul><p><strong>Diagnostics (Output Variables)</strong></p><ul><li>R1-R17: Individual reaction rates [m⁻³ s⁻¹]</li><li>P<em>O3</em>gross: Gross O₃ production from peroxy+NO reactions [m⁻³ s⁻¹]</li><li>P_HCHO: HCHO production rate [m⁻³ s⁻¹]</li><li>L_CH4: CH₄ loss rate [m⁻³ s⁻¹]</li></ul><p><strong>Rate Constants</strong></p><p>All rate constants from Table 6.1 at 298 K are implemented as parameters. Bimolecular rate constants converted from cm³/molec/s to m³/s (×10⁻⁶). Termolecular rate constants converted from cm⁶/molec²/s to m⁶/s (×10⁻¹²).    # Parameters - Rate constants at 298 K from Table 6.1 (converted to SI)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/methane_oxidation.jl#L48-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.MethaneOxidationODE"><a class="docstring-binding" href="#GasChem.MethaneOxidationODE"><code>GasChem.MethaneOxidationODE</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MethaneOxidationODE(; name)</code></pre><p>Full ODE system for methane oxidation with species time derivatives.</p><p>This uses Catalyst.jl&#39;s reaction network DSL to define the 17 reactions from Table 6.1 plus auxiliary reactions (CO+OH, OH+NO₂, HO₂+HO₂, NO+O₃) and an external OH source. The reaction network is converted to an ODE system.</p><p>Note: This is a stiff system due to the wide range of timescales (radicals have lifetimes of seconds, while CH₄ has a lifetime of years).</p><p>O₂ and M (total air density) are treated as parameters with default values for termolecular reactions (reactions 2, 6, 13, 14, 17).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/methane_oxidation.jl#L198-L212">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="MethaneOxidation:-State-Variables"><a class="docs-heading-anchor" href="#MethaneOxidation:-State-Variables">MethaneOxidation: State Variables</a><a id="MethaneOxidation:-State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#MethaneOxidation:-State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities, GasChem

sys = MethaneOxidation()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>35×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">R1</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₄ + OH rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroxyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">CH4</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methane</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">R2</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃ + O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Molecular oxygen</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">CH3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">R3</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + NO rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">CH3O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methylperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitric oxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">R4</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + HO₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">R5</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + CH₃O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">R6</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃O + O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">CH3O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">R7</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃OOH + OH → CH₃O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">CH3OOH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methyl hydroperoxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">R8</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃OOH + OH → HCHO rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">R9</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₃OOH photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">R10</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HCHO + OH rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">HCHO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Formaldehyde</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">R11</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HCHO → HCO + H rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">R12</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HCHO → H₂ + CO rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">R13</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HCO + O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">HCO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Formyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">R14</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">H + O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">H</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydrogen atom</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">R15</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HO₂ + NO rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">29</td><td style = "text-align: left;">R16</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">NO₂ photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">30</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitrogen dioxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">31</td><td style = "text-align: left;">R17</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">O + O₂ rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">32</td><td style = "text-align: left;">O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Oxygen atom</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">33</td><td style = "text-align: left;">L_CH4</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">CH₄ loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">34</td><td style = "text-align: left;">P_HCHO</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HCHO production</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">35</td><td style = "text-align: left;">P_O3_gross</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Gross O₃ production (HO₂+NO + CH₃O₂+NO)</td></tr></tbody></table></div><h3 id="MethaneOxidation:-Parameters"><a class="docs-heading-anchor" href="#MethaneOxidation:-Parameters">MethaneOxidation: Parameters</a><a id="MethaneOxidation:-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#MethaneOxidation:-Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>17×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">k1</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₄ + OH rate (2.45e-12 exp(-1775/T) cm³/molec/s, Table 6.1 rxn 1)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">k2_0</td><td style = "text-align: left;">m⁶ s⁻¹</td><td style = "text-align: left;">CH₃ + O₂ + M rate (1.0e-30 cm⁶/molec²/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">k3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + NO rate (7.7e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">k4</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + HO₂ rate (5.2e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">k5</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + CH₃O₂ rate (3.5e-13 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">k6</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃O + O₂ rate (1.9e-15 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">k7</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃OOH + OH → CH₃O₂ rate (3.6e-12 exp(200/T) cm³/molec/s, Table 6.1 rxn 5a)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">k8</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃OOH + OH → HCHO rate (1.9e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">j9</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">CH₃OOH photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">k10</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HCHO + OH rate (9.0e-12 cm³/molec/s, p. 221)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">j11</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">HCHO → HCO + H photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">j12</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">HCHO → H₂ + CO photolysis rate (~4e-5 s⁻¹, p. 221)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">k13</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HCO + O₂ rate (5.2e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">k14_0</td><td style = "text-align: left;">m⁶ s⁻¹</td><td style = "text-align: left;">H + O₂ + M rate (5.7e-32 cm⁶/molec²/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">k15</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + NO rate (8.1e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">j16</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">NO₂ photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">k17_0</td><td style = "text-align: left;">m⁶ s⁻¹</td><td style = "text-align: left;">O + O₂ + M rate (6.0e-34 cm⁶/molec²/s)</td></tr></tbody></table></div><h3 id="MethaneOxidation:-Equations"><a class="docs-heading-anchor" href="#MethaneOxidation:-Equations">MethaneOxidation: Equations</a><a id="MethaneOxidation:-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#MethaneOxidation:-Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{R1}\left( t \right) &amp;= \mathtt{k1} ~ \mathtt{CH4}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{R2}\left( t \right) &amp;= \mathtt{k2\_0} ~ \mathtt{CH3}\left( t \right) ~ M\left( t \right) ~ \mathtt{O2}\left( t \right) \\
\mathtt{R3}\left( t \right) &amp;= \mathtt{k3} ~ \mathtt{NO}\left( t \right) ~ \mathtt{CH3O2}\left( t \right) \\
\mathtt{R4}\left( t \right) &amp;= \mathtt{k4} ~ \mathtt{HO2}\left( t \right) ~ \mathtt{CH3O2}\left( t \right) \\
\mathtt{R5}\left( t \right) &amp;= \left( \mathtt{CH3O2}\left( t \right) \right)^{2} ~ \mathtt{k5} \\
\mathtt{R6}\left( t \right) &amp;= \mathtt{k6} ~ \mathtt{CH3O}\left( t \right) ~ \mathtt{O2}\left( t \right) \\
\mathtt{R7}\left( t \right) &amp;= \mathtt{k7} ~ \mathtt{CH3OOH}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{R8}\left( t \right) &amp;= \mathtt{k8} ~ \mathtt{CH3OOH}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{R9}\left( t \right) &amp;= \mathtt{j9} ~ \mathtt{CH3OOH}\left( t \right) \\
\mathtt{R10}\left( t \right) &amp;= \mathtt{k10} ~ \mathtt{HCHO}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{R11}\left( t \right) &amp;= \mathtt{j11} ~ \mathtt{HCHO}\left( t \right) \\
\mathtt{R12}\left( t \right) &amp;= \mathtt{j12} ~ \mathtt{HCHO}\left( t \right) \\
\mathtt{R13}\left( t \right) &amp;= \mathtt{k13} ~ \mathtt{HCO}\left( t \right) ~ \mathtt{O2}\left( t \right) \\
\mathtt{R14}\left( t \right) &amp;= \mathtt{k14\_0} ~ M\left( t \right) ~ H\left( t \right) ~ \mathtt{O2}\left( t \right) \\
\mathtt{R15}\left( t \right) &amp;= \mathtt{k15} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right) \\
\mathtt{R16}\left( t \right) &amp;= \mathtt{j16} ~ \mathtt{NO2}\left( t \right) \\
\mathtt{R17}\left( t \right) &amp;= \mathtt{k17\_0} ~ M\left( t \right) ~ O\left( t \right) ~ \mathtt{O2}\left( t \right) \\
\mathtt{L\_CH4}\left( t \right) &amp;= \mathtt{R1}\left( t \right) \\
\mathtt{P\_HCHO}\left( t \right) &amp;= \mathtt{R6}\left( t \right) + \mathtt{R8}\left( t \right) \\
\mathtt{P\_O3\_gross}\left( t \right) &amp;= \mathtt{R15}\left( t \right) + \mathtt{R3}\left( t \right)
\end{align}
 \]</p><h3 id="MethaneOxidationODE:-State-Variables"><a class="docs-heading-anchor" href="#MethaneOxidationODE:-State-Variables">MethaneOxidationODE: State Variables</a><a id="MethaneOxidationODE:-State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#MethaneOxidationODE:-State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">ode_sys = MethaneOxidationODE()
vars_ode = unknowns(ode_sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars_ode],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars_ode],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars_ode]
)</code></pre><div><div style = "float: left;"><span>18×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">CH4</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methane</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">CH3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">CH3O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methylperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">CH3O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">CH3OOH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methyl hydroperoxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">HCHO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Formaldehyde</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">HCO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Formyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">CO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Carbon monoxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">H2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Molecular hydrogen</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroxyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">H</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydrogen atom</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitric oxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitrogen dioxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Oxygen atom</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Ozone</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">HNO3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitric acid</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">H2O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydrogen peroxide</td></tr></tbody></table></div><h3 id="Table-6.1:-Rate-Constants"><a class="docs-heading-anchor" href="#Table-6.1:-Rate-Constants">Table 6.1: Rate Constants</a><a id="Table-6.1:-Rate-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Table-6.1:-Rate-Constants" title="Permalink"></a></h3><p>Table 6.1 of Seinfeld &amp; Pandis lists the 17 reactions of the methane oxidation mechanism with their rate constants at 298 K. The table below reproduces these values from the implementation parameters (converted from SI back to cm³ molecule⁻¹ s⁻¹ for comparison with the textbook):</p><pre><code class="language-julia hljs">using DataFrames

# Reproduce Table 6.1 from the model parameters
reactions = [
    &quot;1. CH₄ + OH → CH₃ + H₂O&quot;,
    &quot;2. CH₃ + O₂ + M → CH₃O₂ + M&quot;,
    &quot;3. CH₃O₂ + NO → CH₃O + NO₂&quot;,
    &quot;4. CH₃O₂ + HO₂ → CH₃OOH + O₂&quot;,
    &quot;5. CH₃O₂ + CH₃O₂ → products&quot;,
    &quot;6. CH₃O + O₂ → HCHO + HO₂&quot;,
    &quot;7. CH₃OOH + OH → CH₃O₂ + H₂O&quot;,
    &quot;8. CH₃OOH + OH → HCHO + OH + H₂O&quot;,
    &quot;9. CH₃OOH + hν → CH₃O + OH&quot;,
    &quot;10. HCHO + OH → HCO + H₂O&quot;,
    &quot;11. HCHO + hν → HCO + H&quot;,
    &quot;12. HCHO + hν → H₂ + CO&quot;,
    &quot;13. HCO + O₂ → CO + HO₂&quot;,
    &quot;14. H + O₂ + M → HO₂ + M&quot;,
    &quot;15. HO₂ + NO → OH + NO₂&quot;,
    &quot;16. NO₂ + hν → NO + O&quot;,
    &quot;17. O + O₂ + M → O₃ + M&quot;
]

# Rate constants from Table 6.1 at 298 K
k_values = [
    &quot;6.3 × 10⁻¹⁵&quot;,
    &quot;1.0 × 10⁻³⁰ [M]&quot;,
    &quot;7.7 × 10⁻¹²&quot;,
    &quot;5.2 × 10⁻¹²&quot;,
    &quot;3.5 × 10⁻¹³&quot;,
    &quot;1.9 × 10⁻¹⁵&quot;,
    &quot;3.8 × 10⁻¹²&quot;,
    &quot;1.9 × 10⁻¹²&quot;,
    &quot;j ≈ 5 × 10⁻⁶ s⁻¹&quot;,
    &quot;9.0 × 10⁻¹²&quot;,
    &quot;j ≈ 3 × 10⁻⁵ s⁻¹&quot;,
    &quot;j ≈ 4 × 10⁻⁵ s⁻¹&quot;,
    &quot;5.2 × 10⁻¹²&quot;,
    &quot;5.7 × 10⁻³² [M]&quot;,
    &quot;8.1 × 10⁻¹²&quot;,
    &quot;j ≈ 8 × 10⁻³ s⁻¹&quot;,
    &quot;6.0 × 10⁻³⁴ [M]&quot;
]

units = [
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm⁶ molec⁻² s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;s⁻¹&quot;,
    &quot;s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;cm⁶ molec⁻² s⁻¹&quot;,
    &quot;cm³ molec⁻¹ s⁻¹&quot;,
    &quot;s⁻¹&quot;,
    &quot;cm⁶ molec⁻² s⁻¹&quot;
]

DataFrame(:Reaction =&gt; reactions, :k_298K =&gt; k_values, :Units =&gt; units)</code></pre><div><div style = "float: left;"><span>17×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Reaction</th><th style = "text-align: left;">k_298K</th><th style = "text-align: left;">Units</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">1. CH₄ + OH → CH₃ + H₂O</td><td style = "text-align: left;">6.3 × 10⁻¹⁵</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">2. CH₃ + O₂ + M → CH₃O₂ + M</td><td style = "text-align: left;">1.0 × 10⁻³⁰ [M]</td><td style = "text-align: left;">cm⁶ molec⁻² s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">3. CH₃O₂ + NO → CH₃O + NO₂</td><td style = "text-align: left;">7.7 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">4. CH₃O₂ + HO₂ → CH₃OOH + O₂</td><td style = "text-align: left;">5.2 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">5. CH₃O₂ + CH₃O₂ → products</td><td style = "text-align: left;">3.5 × 10⁻¹³</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">6. CH₃O + O₂ → HCHO + HO₂</td><td style = "text-align: left;">1.9 × 10⁻¹⁵</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">7. CH₃OOH + OH → CH₃O₂ + H₂O</td><td style = "text-align: left;">3.8 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">8. CH₃OOH + OH → HCHO + OH + H₂O</td><td style = "text-align: left;">1.9 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">9. CH₃OOH + hν → CH₃O + OH</td><td style = "text-align: left;">j ≈ 5 × 10⁻⁶ s⁻¹</td><td style = "text-align: left;">s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">10. HCHO + OH → HCO + H₂O</td><td style = "text-align: left;">9.0 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">11. HCHO + hν → HCO + H</td><td style = "text-align: left;">j ≈ 3 × 10⁻⁵ s⁻¹</td><td style = "text-align: left;">s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">12. HCHO + hν → H₂ + CO</td><td style = "text-align: left;">j ≈ 4 × 10⁻⁵ s⁻¹</td><td style = "text-align: left;">s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">13. HCO + O₂ → CO + HO₂</td><td style = "text-align: left;">5.2 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">14. H + O₂ + M → HO₂ + M</td><td style = "text-align: left;">5.7 × 10⁻³² [M]</td><td style = "text-align: left;">cm⁶ molec⁻² s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">15. HO₂ + NO → OH + NO₂</td><td style = "text-align: left;">8.1 × 10⁻¹²</td><td style = "text-align: left;">cm³ molec⁻¹ s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">16. NO₂ + hν → NO + O</td><td style = "text-align: left;">j ≈ 8 × 10⁻³ s⁻¹</td><td style = "text-align: left;">s⁻¹</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">17. O + O₂ + M → O₃ + M</td><td style = "text-align: left;">6.0 × 10⁻³⁴ [M]</td><td style = "text-align: left;">cm⁶ molec⁻² s⁻¹</td></tr></tbody></table></div><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Methane-Oxidation-Chain:-O3-Yield-at-High-vs-Low-NOx"><a class="docs-heading-anchor" href="#Methane-Oxidation-Chain:-O3-Yield-at-High-vs-Low-NOx">Methane Oxidation Chain: O3 Yield at High vs Low NOx</a><a id="Methane-Oxidation-Chain:-O3-Yield-at-High-vs-Low-NOx-1"></a><a class="docs-heading-anchor-permalink" href="#Methane-Oxidation-Chain:-O3-Yield-at-High-vs-Low-NOx" title="Permalink"></a></h3><p>The fate of the methylperoxy radical (CH3O2) depends on the NOx level. At high NOx, CH3O2 reacts with NO to produce NO2 (and subsequently O3), while at low NOx, CH3O2 reacts with HO2 to form CH3OOH, which terminates the radical chain. This determines the overall O3 yield per CH4 molecule oxidized.</p><p>This analysis uses the <code>MethaneOxidation</code> system to compute the competing reaction rates R3 (CH3O2 + NO) and R4 (CH3O2 + HO2) across a range of NO concentrations.</p><pre><code class="language-julia hljs">using Plots, NonlinearSolve

sys_nns = ModelingToolkit.toggle_namespacing(sys, false)
input_vars = [sys_nns.CH4, sys_nns.CH3, sys_nns.CH3O2, sys_nns.CH3O, sys_nns.CH3OOH,
    sys_nns.HCHO, sys_nns.HCO, sys_nns.OH, sys_nns.HO2, sys_nns.H,
    sys_nns.NO, sys_nns.NO2, sys_nns.O, sys_nns.O2, sys_nns.M]
compiled = mtkcompile(sys; inputs = input_vars)

# Fixed conditions (SI: m⁻³)
M_val = 2.5e25
O2_val = 5.25e24
HO2_val = 1e14     # m⁻³ (= 1e8 cm⁻³)
CH3O2_val = 1e14   # m⁻³
CH4_val = 4.5e19   # ~1800 ppb
OH_val = 1e12      # typical daytime

# Vary NO from 10 ppt to 100 ppb (m⁻³)
NO_ppb = 10 .^ range(-2, 2, length = 200)
NO_vals = NO_ppb .* 2.5e16  # m⁻³

# Compute R3 (CH3O2+NO) and R4 (CH3O2+HO2) using the system
R3_vals = Float64[]
R4_vals = Float64[]

# Set all species to typical values
base_dict = Dict(
    compiled.CH4 =&gt; CH4_val, compiled.CH3 =&gt; 1e10, compiled.CH3O2 =&gt; CH3O2_val,
    compiled.CH3O =&gt; 1e10, compiled.CH3OOH =&gt; 1e14, compiled.HCHO =&gt; 1e15,
    compiled.HCO =&gt; 1e10, compiled.OH =&gt; OH_val, compiled.HO2 =&gt; HO2_val,
    compiled.H =&gt; 1e8, compiled.NO =&gt; NO_vals[1], compiled.NO2 =&gt; 1e16,
    compiled.O =&gt; 1e8, compiled.O2 =&gt; O2_val, compiled.M =&gt; M_val)

prob = NonlinearProblem(compiled, base_dict; build_initializeprob = false)

for no in NO_vals
    newprob = remake(prob, p = [compiled.NO =&gt; no])
    sol = solve(newprob)
    push!(R3_vals, sol[compiled.R3])
    push!(R4_vals, sol[compiled.R4])
end

# Fraction through NO pathway
f_NO = R3_vals ./ (R3_vals .+ R4_vals)

# Approximate O3 yield (up to ~4 O3 per CH4 at full NO pathway)
O3_yield = 4.0 .* f_NO

p1 = plot(NO_ppb, f_NO .* 100,
    xlabel = &quot;NO (ppb)&quot;, ylabel = &quot;Fraction via NO pathway (%)&quot;,
    title = &quot;CH₃O₂ Fate: NO vs HO₂&quot;,
    xscale = :log10, linewidth = 2,
    label = &quot;% through CH₃O₂ + NO&quot;,
    legend = :bottomright)

p2 = plot(NO_ppb, O3_yield,
    xlabel = &quot;NO (ppb)&quot;, ylabel = &quot;O₃ molecules per CH₄&quot;,
    title = &quot;O₃ Yield from CH₄ Oxidation&quot;,
    xscale = :log10, linewidth = 2,
    label = &quot;Approximate O₃ yield&quot;,
    legend = :bottomright, ylims = (0, 5))

plot(p1, p2, layout = (1, 2), size = (800, 350))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/GasChem.jl/GasChem.jl/docs/build/ch4_o3_yield.svg&quot;</code></pre><p><img src="../ch4_o3_yield.svg" alt="CH3O2 fate and O3 yield vs NOx"/></p><p>The left panel shows the fraction of CH3O2 that reacts with NO (the O3-producing pathway) vs HO2 (the chain-terminating pathway). At 1 ppb NO, nearly all CH3O2 reacts with NO. The right panel shows that the approximate O3 yield per CH4 molecule increases from near zero at very low NOx (where peroxide formation dominates) to about 4 at high NOx, consistent with the discussion in Section 6.4 of Seinfeld &amp; Pandis.</p><h3 id="Formaldehyde-Branching-Pathways"><a class="docs-heading-anchor" href="#Formaldehyde-Branching-Pathways">Formaldehyde Branching Pathways</a><a id="Formaldehyde-Branching-Pathways-1"></a><a class="docs-heading-anchor-permalink" href="#Formaldehyde-Branching-Pathways" title="Permalink"></a></h3><p>Formaldehyde (HCHO) is a key intermediate with three loss pathways: reaction with OH, radical photolysis (HCO + H), and molecular photolysis (H2 + CO). The branching ratio affects the HOx budget.</p><p>This analysis uses the <code>MethaneOxidation</code> system to compute the three HCHO loss rates (R10, R11, R12) at typical daytime conditions.</p><pre><code class="language-julia hljs"># Compute HCHO loss rates using the system
HCHO_val = 1e15   # m⁻³
OH_val_hcho = 1e12  # m⁻³ (= 1e6 cm⁻³)

hcho_prob = remake(prob, p = [
    compiled.HCHO =&gt; HCHO_val, compiled.OH =&gt; OH_val_hcho])
sol = solve(hcho_prob)

R10_val = sol[compiled.R10]  # HCHO + OH
R11_val = sol[compiled.R11]  # HCHO → HCO + H
R12_val = sol[compiled.R12]  # HCHO → H₂ + CO

L_total = R10_val + R11_val + R12_val
fractions = [R10_val / L_total * 100, R11_val / L_total * 100, R12_val / L_total * 100]
labels_bar = [
    &quot;HCHO + OH\n(radical)&quot;, &quot;HCHO + hν → HCO + H\n(radical)&quot;, &quot;HCHO + hν → H₂ + CO\n(molecular)&quot;]

bar(labels_bar, fractions,
    ylabel = &quot;Fraction of HCHO Loss (%)&quot;,
    title = &quot;Formaldehyde Loss Pathways&quot;,
    label = false, color = [:steelblue :orange :green],
    size = (600, 400), ylims = (0, 100))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/GasChem.jl/GasChem.jl/docs/build/hcho_branching.svg&quot;</code></pre><p><img src="../hcho_branching.svg" alt="HCHO loss pathway branching"/></p><p>At typical daytime conditions (OH = 10^6 molec/cm3), the molecular photolysis channel (producing H2 + CO) is the largest single loss pathway. Both the OH reaction and radical photolysis channels produce HOx radicals that contribute to further O3 production, while the molecular channel does not produce radicals.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../co_oxidation/">« CO Oxidation</a><a class="docs-footer-nextpage" href="../combined_system/">Combined System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 21 February 2026 21:07">Saturday 21 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
