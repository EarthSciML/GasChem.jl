<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Combined System · GasChem.jl</title><meta name="title" content="Combined System · GasChem.jl"/><meta property="og:title" content="Combined System · GasChem.jl"/><meta property="twitter:title" content="Combined System · GasChem.jl"/><meta name="description" content="Documentation for GasChem.jl."/><meta property="og:description" content="Documentation for GasChem.jl."/><meta property="twitter:description" content="Documentation for GasChem.jl."/><meta property="og:url" content="https://gaschem.earthsci.dev/combined_system/"/><meta property="twitter:url" content="https://gaschem.earthsci.dev/combined_system/"/><link rel="canonical" href="https://gaschem.earthsci.dev/combined_system/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChem.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../AtmosphericLifetime/">Atmospheric Lifetime</a></li><li><a class="tocitem" href="../superfast/">SuperFast</a></li><li><span class="tocitem">GEOS-Chem</span><ul><li><a class="tocitem" href="../geoschem/overview/">Overview</a></li><li><a class="tocitem" href="../geoschem/states/">State Variables</a></li><li><a class="tocitem" href="../geoschem/params/">Parameters</a></li></ul></li><li><span class="tocitem">Seinfeld &amp; Pandis Ch. 6</span><ul><li><a class="tocitem" href="../oh_production/">OH Production</a></li><li><a class="tocitem" href="../nox_photochemistry/">NOx Photochemistry</a></li><li><a class="tocitem" href="../co_oxidation/">CO Oxidation</a></li><li><a class="tocitem" href="../methane_oxidation/">Methane Oxidation</a></li><li class="is-active"><a class="tocitem" href>Combined System</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../radiation_fundamentals/">Radiation Fundamentals</a></li><li><a class="tocitem" href="../StratosphericChemistry/">Stratospheric Chemistry</a></li><li><a class="tocitem" href="../climate_forcing/">Climate Forcing</a></li><li><a class="tocitem" href="../composing_models/">Composing models</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Seinfeld &amp; Pandis Ch. 6</a></li><li class="is-active"><a href>Combined System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Combined System</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl/blob/main/docs/src/combined_system.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="combined_system"><a class="docs-heading-anchor" href="#combined_system">Combined System</a><a id="combined_system-1"></a><a class="docs-heading-anchor-permalink" href="#combined_system" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The <code>TroposphericChemistrySystem</code> integrates the individual chemistry mechanisms from Chapter 6 into a comprehensive tropospheric chemistry diagnostic model. It couples:</p><ul><li>OH production from O3 photolysis (Section 6.1, via <code>OHProduction</code>)</li><li>NOx photochemical cycle (Section 6.2, via <code>NOxPhotochemistry</code>)</li><li>CO oxidation and HOx cycling (Section 6.3, via <code>COOxidation</code>)</li></ul><p>The systems are coupled through shared species (OH, HO2, NO, NO2, O3) and the combined system computes aggregate diagnostics including net O3 production, OPE, and HOx chain length.</p><p>Condition systems provide typical atmospheric conditions for different environments.</p><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition. John Wiley &amp; Sons. Chapter 6.</p><article><details class="docstring" open="true"><summary id="GasChem.TroposphericChemistrySystem"><a class="docstring-binding" href="#GasChem.TroposphericChemistrySystem"><code>GasChem.TroposphericChemistrySystem</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">TroposphericChemistrySystem(; name)</code></pre><p>Combined ModelingToolkit System for tropospheric chemistry diagnostics.</p><p>This system couples the OH production, NOx cycling, and CO/CH₄ oxidation mechanisms to create a comprehensive diagnostic model of tropospheric photochemistry.</p><p><strong>Key coupling points:</strong></p><ul><li>OH is produced from O₃ photolysis and HO₂ + NO reaction</li><li>OH is consumed by CO, CH₄, and other species</li><li>HO₂ is produced from CO/VOC oxidation</li><li>HO₂ is lost to NO (producing OH) and self-reaction</li><li>NOx cycles between NO and NO₂ through O₃ and peroxy radicals</li><li>O₃ is produced when peroxy radicals oxidize NO to NO₂</li></ul><p><strong>Subsystem Composition:</strong></p><ul><li><code>oh</code>: OHProduction subsystem (Section 6.1)</li><li><code>nox</code>: NOxPhotochemistry subsystem (Section 6.2)</li><li><code>co</code>: COOxidation subsystem (Section 6.3)</li></ul><p><strong>Input Variables</strong></p><p>All species concentrations must be provided as inputs [m⁻³].</p><p><strong>Diagnostic outputs:</strong></p><ul><li>P<em>O3</em>net: Net ozone production rate [m⁻³ s⁻¹]</li><li>OPE: Ozone production efficiency [dimensionless]</li><li>HOx: Total HOx (OH + HO₂) [m⁻³]    # =========================================================================</li><li>chain_length: HOx chain length [dimensionless]    # Subsystems (composed from individual component functions)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/combined_system.jl#L20-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.TypicalConditions"><a class="docstring-binding" href="#GasChem.TypicalConditions"><code>GasChem.TypicalConditions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">TypicalConditions(; name)</code></pre><p>ModelingToolkit System representing typical lower troposphere conditions.</p><p>All concentrations are parameters in SI units (m⁻³).</p><p>Based on values from Seinfeld &amp; Pandis Chapter 6.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/combined_system.jl#L168-L176">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.UrbanConditions"><a class="docstring-binding" href="#GasChem.UrbanConditions"><code>GasChem.UrbanConditions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">UrbanConditions(; name)</code></pre><p>ModelingToolkit System representing typical urban conditions with elevated NOx.</p><p>All concentrations are parameters in SI units (m⁻³).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/combined_system.jl#L212-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.RemoteConditions"><a class="docstring-binding" href="#GasChem.RemoteConditions"><code>GasChem.RemoteConditions</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">RemoteConditions(; name)</code></pre><p>ModelingToolkit System representing typical remote/background conditions with low NOx.</p><p>All concentrations are parameters in SI units (m⁻³).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/combined_system.jl#L254-L260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.get_conditions_dict"><a class="docstring-binding" href="#GasChem.get_conditions_dict"><code>GasChem.get_conditions_dict</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_conditions_dict(sys)</code></pre><p>Helper to extract default parameter values from a conditions System as a Dict{Symbol,Float64}. This is a convenience function for use in tests and analysis code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/combined_system.jl#L296-L301">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities, GasChem

sys = TroposphericChemistrySystem()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>61×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">oh₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Ozone concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Ozone</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">oh₊H2O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Water vapor concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">H2O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Water vapor</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">oh₊M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air number density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">nox₊NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitric oxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">nox₊NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Nitrogen dioxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">nox₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₃ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">nox₊O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Molecular oxygen</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">nox₊M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air number density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">co₊CO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">CO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">CO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Carbon monoxide</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">co₊OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">OH concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroxyl radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">co₊HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Hydroperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">co₊NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">co₊NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">co₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₃ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">NOx</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total NOx</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">HOx</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total HOx</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">RO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total organic peroxy radicals</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">CH3O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Methylperoxy radical</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">P_O3_total</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Total O₃ production</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">29</td><td style = "text-align: left;">L_O3_total</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Total O₃ loss</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">30</td><td style = "text-align: left;">P_O3_net</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Net O₃ tendency</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">31</td><td style = "text-align: left;">L_NOx</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">NOx loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">32</td><td style = "text-align: left;">OPE</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ozone production efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">33</td><td style = "text-align: left;">chain_length</td><td style = "text-align: left;"></td><td style = "text-align: left;">HOx chain length (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">34</td><td style = "text-align: left;">co₊chain_length</td><td style = "text-align: left;"></td><td style = "text-align: left;">HOx chain length (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">35</td><td style = "text-align: left;">oh₊O1D</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O(¹D) steady-state concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">36</td><td style = "text-align: left;">oh₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Ozone concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">37</td><td style = "text-align: left;">oh₊M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air number density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">38</td><td style = "text-align: left;">oh₊H2O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Water vapor concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">39</td><td style = "text-align: left;">oh₊ε_OH</td><td style = "text-align: left;"></td><td style = "text-align: left;">OH yield fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">40</td><td style = "text-align: left;">oh₊P_OH</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">OH production rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">41</td><td style = "text-align: left;">nox₊O</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O atom concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">42</td><td style = "text-align: left;">nox₊NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">43</td><td style = "text-align: left;">nox₊O2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">44</td><td style = "text-align: left;">nox₊M</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Total air number density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">45</td><td style = "text-align: left;">nox₊O3_pss</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Photostationary state O₃</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">46</td><td style = "text-align: left;">nox₊NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">47</td><td style = "text-align: left;">nox₊Φ</td><td style = "text-align: left;"></td><td style = "text-align: left;">Photostationary state parameter (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">48</td><td style = "text-align: left;">nox₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₃ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">49</td><td style = "text-align: left;">nox₊P_O3</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Net O₃ production rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">50</td><td style = "text-align: left;">co₊L_OH</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">OH loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">51</td><td style = "text-align: left;">co₊OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">OH concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">52</td><td style = "text-align: left;">co₊CO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">CO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">53</td><td style = "text-align: left;">co₊NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">54</td><td style = "text-align: left;">co₊O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₃ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">55</td><td style = "text-align: left;">co₊L_HO2</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HO₂ loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">56</td><td style = "text-align: left;">co₊HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">57</td><td style = "text-align: left;">co₊NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">58</td><td style = "text-align: left;">co₊L_HOx</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HOx loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">59</td><td style = "text-align: left;">co₊HO2_ss</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ steady-state (high NOx)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">60</td><td style = "text-align: left;">co₊P_O3</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Net O₃ production rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">61</td><td style = "text-align: left;">co₊chain_length</td><td style = "text-align: left;"></td><td style = "text-align: left;">HOx chain length (dimensionless)</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>18×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">co₊k_HO2_NO</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + NO rate constant (8.1e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">k_CH3O2_NO</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CH₃O₂ + NO rate constant (7.7e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">nox₊k_NO_O3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">NO + O₃ → NO₂ rate (1.9e-14 cm³/molec/s, p. 211)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">co₊k_HO2_O3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + O₃ rate constant (2.0e-15 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">co₊k_OH_O3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">OH + O₃ rate constant (7.3e-14 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">co₊k_OH_NO2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">OH + NO₂ + M rate constant (1.0e-11 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">oh₊j_O3</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">O₃ photolysis rate producing O(¹D) at surface, solar zenith 0°</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">oh₊k3_O2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">O(¹D) + O₂ quenching rate (4.0e-11 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">oh₊f_O2</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fraction of air that is O₂ (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">oh₊k3_N2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">O(¹D) + N₂ quenching rate (2.6e-11 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">oh₊f_N2</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fraction of air that is N₂ (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">oh₊k4</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">O(¹D) + H₂O → 2OH rate (2.2e-10 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">oh₊two</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stoichiometric factor: 2 OH per O(¹D)+H₂O reaction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">nox₊j_NO2</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">NO₂ photolysis rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">nox₊k_O_O2_M</td><td style = "text-align: left;">m⁶ s⁻¹</td><td style = "text-align: left;">O + O₂ + M → O₃ rate (6.0e-34 cm⁶/molec²/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">co₊k_CO_OH</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CO + OH rate constant (2.4e-13 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">co₊k_HO2_HO2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + HO₂ rate constant (2.9e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">co₊two</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stoichiometric factor for HO₂ self-reaction (dimensionless)</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{oh.O3}\left( t \right) &amp;= \mathtt{O3}\left( t \right) \\
\mathtt{oh.H2O}\left( t \right) &amp;= \mathtt{H2O}\left( t \right) \\
\mathtt{oh.M}\left( t \right) &amp;= M\left( t \right) \\
\mathtt{nox.NO}\left( t \right) &amp;= \mathtt{NO}\left( t \right) \\
\mathtt{nox.NO2}\left( t \right) &amp;= \mathtt{NO2}\left( t \right) \\
\mathtt{nox.O3}\left( t \right) &amp;= \mathtt{O3}\left( t \right) \\
\mathtt{nox.O2}\left( t \right) &amp;= \mathtt{O2}\left( t \right) \\
\mathtt{nox.M}\left( t \right) &amp;= M\left( t \right) \\
\mathtt{co.CO}\left( t \right) &amp;= \mathtt{CO}\left( t \right) \\
\mathtt{co.OH}\left( t \right) &amp;= \mathtt{OH}\left( t \right) \\
\mathtt{co.HO2}\left( t \right) &amp;= \mathtt{HO2}\left( t \right) \\
\mathtt{co.NO}\left( t \right) &amp;= \mathtt{NO}\left( t \right) \\
\mathtt{co.NO2}\left( t \right) &amp;= \mathtt{NO2}\left( t \right) \\
\mathtt{co.O3}\left( t \right) &amp;= \mathtt{O3}\left( t \right) \\
\mathtt{NOx}\left( t \right) &amp;= \mathtt{NO}\left( t \right) + \mathtt{NO2}\left( t \right) \\
\mathtt{HOx}\left( t \right) &amp;= \mathtt{HO2}\left( t \right) + \mathtt{OH}\left( t \right) \\
\mathtt{RO2}\left( t \right) &amp;= \mathtt{CH3O2}\left( t \right) \\
\mathtt{P\_O3\_total}\left( t \right) &amp;= \mathtt{co.k\_HO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right) + \mathtt{k\_CH3O2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{CH3O2}\left( t \right) \\
\mathtt{L\_O3\_total}\left( t \right) &amp;= \mathtt{co.k\_HO2\_O3} ~ \mathtt{HO2}\left( t \right) ~ \mathtt{O3}\left( t \right) + \mathtt{co.k\_OH\_O3} ~ \mathtt{OH}\left( t \right) ~ \mathtt{O3}\left( t \right) + \mathtt{nox.k\_NO\_O3} ~ \mathtt{NO}\left( t \right) ~ \mathtt{O3}\left( t \right) \\
\mathtt{P\_O3\_net}\left( t \right) &amp;= \mathtt{P\_O3\_total}\left( t \right) - \mathtt{L\_O3\_total}\left( t \right) \\
\mathtt{L\_NOx}\left( t \right) &amp;= \mathtt{co.k\_OH\_NO2} ~ \mathtt{NO2}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{OPE}\left( t \right) &amp;= \frac{\mathtt{P\_O3\_total}\left( t \right)}{\mathtt{L\_NOx}\left( t \right)} \\
\mathtt{chain\_length}\left( t \right) &amp;= \mathtt{co.chain\_length}\left( t \right) \\
\mathtt{oh.O1D}\left( t \right) &amp;= \frac{\mathtt{oh.j\_O3} ~ \mathtt{oh.O3}\left( t \right)}{\mathtt{oh.k4} ~ \mathtt{oh.H2O}\left( t \right) + \left( \mathtt{oh.f\_N2} ~ \mathtt{oh.k3\_N2} + \mathtt{oh.f\_O2} ~ \mathtt{oh.k3\_O2} \right) ~ \mathtt{oh.M}\left( t \right)} \\
\mathtt{oh.\varepsilon\_OH}\left( t \right) &amp;= \frac{\mathtt{oh.k4} ~ \mathtt{oh.two} ~ \mathtt{oh.H2O}\left( t \right)}{\mathtt{oh.k4} ~ \mathtt{oh.H2O}\left( t \right) + \left( \mathtt{oh.f\_N2} ~ \mathtt{oh.k3\_N2} + \mathtt{oh.f\_O2} ~ \mathtt{oh.k3\_O2} \right) ~ \mathtt{oh.M}\left( t \right)} \\
\mathtt{oh.P\_OH}\left( t \right) &amp;= \mathtt{oh.j\_O3} ~ \mathtt{oh.\varepsilon\_OH}\left( t \right) ~ \mathtt{oh.O3}\left( t \right) \\
\mathtt{nox.O}\left( t \right) &amp;= \frac{\mathtt{nox.j\_NO2} ~ \mathtt{nox.NO2}\left( t \right)}{\mathtt{nox.k\_O\_O2\_M} ~ \mathtt{nox.O2}\left( t \right) ~ \mathtt{nox.M}\left( t \right)} \\
\mathtt{nox.O3\_pss}\left( t \right) &amp;= \frac{\mathtt{nox.j\_NO2} ~ \mathtt{nox.NO2}\left( t \right)}{\mathtt{nox.k\_NO\_O3} ~ \mathtt{nox.NO}\left( t \right)} \\
\mathtt{nox.\Phi}\left( t \right) &amp;= \frac{\mathtt{nox.j\_NO2} ~ \mathtt{nox.NO2}\left( t \right)}{\mathtt{nox.k\_NO\_O3} ~ \mathtt{nox.O3}\left( t \right) ~ \mathtt{nox.NO}\left( t \right)} \\
\mathtt{nox.P\_O3}\left( t \right) &amp;= \mathtt{nox.j\_NO2} ~ \mathtt{nox.NO2}\left( t \right) - \mathtt{nox.k\_NO\_O3} ~ \mathtt{nox.O3}\left( t \right) ~ \mathtt{nox.NO}\left( t \right) \\
\mathtt{co.L\_OH}\left( t \right) &amp;= \mathtt{co.k\_CO\_OH} ~ \mathtt{co.CO}\left( t \right) ~ \mathtt{co.OH}\left( t \right) + \mathtt{co.k\_OH\_NO2} ~ \mathtt{co.OH}\left( t \right) ~ \mathtt{co.NO2}\left( t \right) + \mathtt{co.k\_OH\_O3} ~ \mathtt{co.O3}\left( t \right) ~ \mathtt{co.OH}\left( t \right) \\
\mathtt{co.L\_HO2}\left( t \right) &amp;= \mathtt{co.k\_HO2\_NO} ~ \mathtt{co.HO2}\left( t \right) ~ \mathtt{co.NO}\left( t \right) + \mathtt{co.k\_HO2\_O3} ~ \mathtt{co.HO2}\left( t \right) ~ \mathtt{co.O3}\left( t \right) + \left( \mathtt{co.HO2}\left( t \right) \right)^{2} ~ \mathtt{co.k\_HO2\_HO2} ~ \mathtt{co.two} \\
\mathtt{co.L\_HOx}\left( t \right) &amp;= \mathtt{co.k\_OH\_NO2} ~ \mathtt{co.OH}\left( t \right) ~ \mathtt{co.NO2}\left( t \right) + \left( \mathtt{co.HO2}\left( t \right) \right)^{2} ~ \mathtt{co.k\_HO2\_HO2} ~ \mathtt{co.two} \\
\mathtt{co.HO2\_ss}\left( t \right) &amp;= \frac{\mathtt{co.k\_CO\_OH} ~ \mathtt{co.CO}\left( t \right) ~ \mathtt{co.OH}\left( t \right)}{\mathtt{co.k\_HO2\_NO} ~ \mathtt{co.NO}\left( t \right)} \\
\mathtt{co.P\_O3}\left( t \right) &amp;= \mathtt{co.k\_HO2\_NO} ~ \mathtt{co.HO2}\left( t \right) ~ \mathtt{co.NO}\left( t \right) - \mathtt{co.k\_HO2\_O3} ~ \mathtt{co.HO2}\left( t \right) ~ \mathtt{co.O3}\left( t \right) - \mathtt{co.k\_OH\_O3} ~ \mathtt{co.O3}\left( t \right) ~ \mathtt{co.OH}\left( t \right) \\
\mathtt{co.chain\_length}\left( t \right) &amp;= \frac{\mathtt{co.k\_HO2\_NO} ~ \mathtt{co.HO2}\left( t \right) ~ \mathtt{co.NO}\left( t \right)}{\mathtt{co.L\_HOx}\left( t \right)}
\end{align}
 \]</p><h3 id="Typical-Atmospheric-Conditions"><a class="docs-heading-anchor" href="#Typical-Atmospheric-Conditions">Typical Atmospheric Conditions</a><a id="Typical-Atmospheric-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Atmospheric-Conditions" title="Permalink"></a></h3><p>The module provides condition systems for three atmospheric environments:</p><pre><code class="language-julia hljs">using DataFrames

conditions = [
    (&quot;Background&quot;, get_conditions_dict(TypicalConditions())),
    (&quot;Urban&quot;, get_conditions_dict(UrbanConditions())),
    (&quot;Remote&quot;, get_conditions_dict(RemoteConditions()))
]

# Show key species for each condition
species = [:O3, :NO, :NO2, :CO, :OH, :HO2]
header = vcat([:Species, :Units], [Symbol(c[1]) for c in conditions])

rows = []
for s in species
    ppb_factor = 2.5e16  # m⁻³ per ppb at STP
    vals = [c[2][s] for c in conditions]
    ppb_vals = vals ./ ppb_factor
    push!(rows,
        (
            Species = string(s),
            Units = &quot;ppb&quot;,
            Background = round(ppb_vals[1], sigdigits = 3),
            Urban = round(ppb_vals[2], sigdigits = 3),
            Remote = round(ppb_vals[3], sigdigits = 3)
        ))
end
DataFrame(rows)</code></pre><div><div style = "float: left;"><span>6×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Species</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Background</th><th style = "text-align: left;">Urban</th><th style = "text-align: left;">Remote</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">O3</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">40.0</td><td style = "text-align: right;">80.0</td><td style = "text-align: right;">30.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">10.0</td><td style = "text-align: right;">0.01</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">30.0</td><td style = "text-align: right;">0.02</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">CO</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">100.0</td><td style = "text-align: right;">2000.0</td><td style = "text-align: right;">80.0</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">4.0e-5</td><td style = "text-align: right;">2.0e-5</td><td style = "text-align: right;">4.0e-5</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">ppb</td><td style = "text-align: right;">0.004</td><td style = "text-align: right;">0.002</td><td style = "text-align: right;">0.008</td></tr></tbody></table></div><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="O3-Production-in-Different-NOx-Regimes"><a class="docs-heading-anchor" href="#O3-Production-in-Different-NOx-Regimes">O3 Production in Different NOx Regimes</a><a id="O3-Production-in-Different-NOx-Regimes-1"></a><a class="docs-heading-anchor-permalink" href="#O3-Production-in-Different-NOx-Regimes" title="Permalink"></a></h3><p>The combined system captures the transition between NOx-limited and VOC-limited regimes. In the NOx-limited regime (remote conditions), O3 production increases linearly with NOx. In the VOC-limited regime (urban conditions), adding more NOx can actually decrease O3.</p><p>This analysis uses the <code>TroposphericChemistrySystem</code> to compute how net O3 production and OPE vary across a range of NOx levels. The HO2 concentration is estimated from steady-state approximations (Eqs. 6.13 and 6.18), and the resulting concentrations are fed into the compiled system to compute the diagnostics.</p><pre><code class="language-julia hljs">using Plots, NonlinearSolve

# Compile the TroposphericChemistrySystem with all species as inputs
sys_nns = ModelingToolkit.toggle_namespacing(sys, false)
input_vars = [sys_nns.O3, sys_nns.NO, sys_nns.NO2, sys_nns.OH, sys_nns.HO2,
    sys_nns.CO, sys_nns.CH3O2, sys_nns.H2O, sys_nns.M, sys_nns.O2]
compiled = mtkcompile(sys; inputs = input_vars)

# Extract rate constants from the system parameters for HO2 estimation
k_HO2_NO_val = Float64(ModelingToolkit.getdefault(sys.co.k_HO2_NO))
k_HO2_HO2_val = Float64(ModelingToolkit.getdefault(sys.co.k_HO2_HO2))
k_CO_OH_val = Float64(ModelingToolkit.getdefault(sys.co.k_CO_OH))

# Fixed conditions (background, SI: m⁻³)
CO_val = 2.5e18     # 100 ppb
O3_val = 1e18       # 40 ppb
OH_val = 1e12       # typical daytime
CH3O2_val = 1e14    # typical
H2O_val = 4e23
M_val = 2.5e25
O2_val = 5.25e24
P_HOx_est = 1e12    # m⁻³/s (for HO2 estimation from Eq. 6.13)

# Vary NO from 10 ppt to 100 ppb
NO_ppb = 10 .^ range(-2, 2, length = 300)
NO_vals = NO_ppb .* 2.5e16  # m⁻³
NO2_vals = 2 .* NO_vals     # assume NO2/NO ratio ~ 2

# Estimate HO2 from steady state (Eqs. 6.13 and 6.18)
HO2_high_NOx = k_CO_OH_val .* CO_val .* OH_val ./ (k_HO2_NO_val .* NO_vals)
HO2_low_NOx = sqrt(P_HOx_est / (2 * k_HO2_HO2_val))
HO2_vals = min.(HO2_high_NOx, HO2_low_NOx)

# Solve the combined system for each NO level
prob = NonlinearProblem(compiled,
    Dict(compiled.O3 =&gt; O3_val, compiled.NO =&gt; NO_vals[1], compiled.NO2 =&gt; NO2_vals[1],
        compiled.OH =&gt; OH_val, compiled.HO2 =&gt; HO2_vals[1], compiled.CO =&gt; CO_val,
        compiled.CH3O2 =&gt; CH3O2_val, compiled.H2O =&gt; H2O_val, compiled.M =&gt; M_val,
        compiled.O2 =&gt; O2_val);
    build_initializeprob = false)

P_O3_net_vals = Float64[]
OPE_result = Float64[]
for i in eachindex(NO_ppb)
    newprob = remake(prob,
        p = [compiled.NO =&gt; NO_vals[i], compiled.NO2 =&gt; NO2_vals[i],
            compiled.HO2 =&gt; HO2_vals[i]])
    sol = solve(newprob)
    push!(P_O3_net_vals, sol[compiled.P_O3_net])
    push!(OPE_result, sol[compiled.OPE])
end

p1 = plot(NO_ppb, P_O3_net_vals ./ 1e12,
    xlabel = &quot;NO (ppb)&quot;,
    ylabel = &quot;Net P(O₃) (10¹² m⁻³ s⁻¹)&quot;,
    title = &quot;Net O₃ Production vs NOx&quot;,
    xscale = :log10, linewidth = 2,
    label = &quot;P(O₃)_net&quot;, legend = :topleft)
vline!([0.1], linestyle = :dash, color = :gray, label = &quot;Background NO&quot;)
vline!([10.0], linestyle = :dash, color = :red, label = &quot;Urban NO&quot;)

p2 = plot(NO_ppb, OPE_result,
    xlabel = &quot;NO (ppb)&quot;,
    ylabel = &quot;OPE (mol O₃ / mol NOx)&quot;,
    title = &quot;Ozone Production Efficiency&quot;,
    xscale = :log10, yscale = :log10, linewidth = 2,
    label = &quot;OPE&quot;, legend = :topright, ylims = (0.1, 1000))
hline!([3.0], linestyle = :dot, color = :red, label = &quot;Urban OPE ~ 1-3&quot;)
hline!([15.0], linestyle = :dot, color = :blue, label = &quot;Remote OPE ~ 10-30&quot;)

plot(p1, p2, layout = (1, 2), size = (900, 400))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/GasChem.jl/GasChem.jl/docs/build/combined_o3_regimes.svg&quot;</code></pre><p><img src="../combined_o3_regimes.svg" alt="O3 production in different NOx regimes"/></p><p>The left panel shows that net O3 production peaks at intermediate NOx levels and decreases at very high NOx due to O3 titration by NO and reduced HO2 concentrations. The right panel shows that OPE decreases monotonically with increasing NOx, from OPE &gt; 10 in remote conditions to OPE of 1-3 in urban environments, consistent with Section 6.3 of Seinfeld &amp; Pandis.</p><h3 id="Comparison-of-Atmospheric-Conditions"><a class="docs-heading-anchor" href="#Comparison-of-Atmospheric-Conditions">Comparison of Atmospheric Conditions</a><a id="Comparison-of-Atmospheric-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-Atmospheric-Conditions" title="Permalink"></a></h3><p>This table computes key diagnostics for each of the three standard atmospheric environments by compiling and solving the <code>TroposphericChemistrySystem</code> with the conditions from each environment.</p><pre><code class="language-julia hljs">environments = [
    (&quot;Background&quot;, get_conditions_dict(TypicalConditions())),
    (&quot;Urban&quot;, get_conditions_dict(UrbanConditions())),
    (&quot;Remote&quot;, get_conditions_dict(RemoteConditions()))
]

results = []
for (name, cond) in environments
    env_prob = remake(prob,
        p = [compiled.O3 =&gt; cond[:O3], compiled.NO =&gt; cond[:NO],
            compiled.NO2 =&gt; cond[:NO2], compiled.OH =&gt; cond[:OH],
            compiled.HO2 =&gt; cond[:HO2], compiled.CO =&gt; cond[:CO],
            compiled.CH3O2 =&gt; cond[:CH3O2], compiled.H2O =&gt; cond[:H2O],
            compiled.M =&gt; cond[:M], compiled.O2 =&gt; cond[:O2]])
    sol = solve(env_prob)

    push!(results,
        (
            Environment = name,
            NO_ppb = round(cond[:NO] / 2.5e16, sigdigits = 3),
            O3_ppb = round(cond[:O3] / 2.5e16, sigdigits = 3),
            P_O3 = round(sol[compiled.P_O3_total], sigdigits = 3),
            OPE = round(sol[compiled.OPE], sigdigits = 3),
            Chain_Length = round(sol[compiled.chain_length], sigdigits = 3)
        ))
end

DataFrame(results)</code></pre><div><div style = "float: left;"><span>3×6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Environment</th><th style = "text-align: left;">NO_ppb</th><th style = "text-align: left;">O3_ppb</th><th style = "text-align: left;">P_O3</th><th style = "text-align: left;">OPE</th><th style = "text-align: left;">Chain_Length</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Background</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">40.0</td><td style = "text-align: right;">3.95e12</td><td style = "text-align: right;">15.8</td><td style = "text-align: right;">6.57</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Urban</td><td style = "text-align: right;">10.0</td><td style = "text-align: right;">80.0</td><td style = "text-align: right;">1.98e14</td><td style = "text-align: right;">52.7</td><td style = "text-align: right;">26.9</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Remote</td><td style = "text-align: right;">0.01</td><td style = "text-align: right;">30.0</td><td style = "text-align: right;">7.9e11</td><td style = "text-align: right;">158.0</td><td style = "text-align: right;">1.71</td></tr></tbody></table></div><p>This table shows how the key photochemical diagnostics vary across different atmospheric environments, illustrating the transition from NOx-limited (remote, high OPE and long chain length) to VOC-limited (urban, low OPE and short chain length) regimes discussed in Chapter 6.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../methane_oxidation/">« Methane Oxidation</a><a class="docs-footer-nextpage" href="../radiation_fundamentals/">Radiation Fundamentals »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 21 February 2026 21:20">Saturday 21 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
