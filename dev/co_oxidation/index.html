<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CO Oxidation · GasChem.jl</title><meta name="title" content="CO Oxidation · GasChem.jl"/><meta property="og:title" content="CO Oxidation · GasChem.jl"/><meta property="twitter:title" content="CO Oxidation · GasChem.jl"/><meta name="description" content="Documentation for GasChem.jl."/><meta property="og:description" content="Documentation for GasChem.jl."/><meta property="twitter:description" content="Documentation for GasChem.jl."/><meta property="og:url" content="https://gaschem.earthsci.dev/co_oxidation/"/><meta property="twitter:url" content="https://gaschem.earthsci.dev/co_oxidation/"/><link rel="canonical" href="https://gaschem.earthsci.dev/co_oxidation/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GasChem.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../AtmosphericLifetime/">Atmospheric Lifetime</a></li><li><a class="tocitem" href="../superfast/">SuperFast</a></li><li><span class="tocitem">GEOS-Chem</span><ul><li><a class="tocitem" href="../geoschem/overview/">Overview</a></li><li><a class="tocitem" href="../geoschem/states/">State Variables</a></li><li><a class="tocitem" href="../geoschem/params/">Parameters</a></li></ul></li><li><span class="tocitem">Seinfeld &amp; Pandis Ch. 6</span><ul><li><a class="tocitem" href="../oh_production/">OH Production</a></li><li><a class="tocitem" href="../nox_photochemistry/">NOx Photochemistry</a></li><li class="is-active"><a class="tocitem" href>CO Oxidation</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../methane_oxidation/">Methane Oxidation</a></li><li><a class="tocitem" href="../combined_system/">Combined System</a></li></ul></li><li><a class="tocitem" href="../radiation_fundamentals/">Radiation Fundamentals</a></li><li><a class="tocitem" href="../StratosphericChemistry/">Stratospheric Chemistry</a></li><li><a class="tocitem" href="../climate_forcing/">Climate Forcing</a></li><li><a class="tocitem" href="../composing_models/">Composing models</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Seinfeld &amp; Pandis Ch. 6</a></li><li class="is-active"><a href>CO Oxidation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CO Oxidation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/GasChem.jl/blob/main/docs/src/co_oxidation.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="co_oxidation"><a class="docs-heading-anchor" href="#co_oxidation">CO Oxidation</a><a id="co_oxidation-1"></a><a class="docs-heading-anchor-permalink" href="#co_oxidation" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>CO oxidation is the simplest hydrocarbon oxidation mechanism and illustrates the fundamental HOx cycling that drives tropospheric ozone production. The net reaction is:</p><pre><code class="nohighlight hljs">CO + 2O2 + hv -&gt; CO2 + O3</code></pre><p>The key feature is that OH is regenerated through the HO2 + NO reaction, allowing catalytic ozone production. The HOx chain length (number of OH-HO2 cycles before termination) and the Ozone Production Efficiency (OPE = moles O3 produced per mole NOx consumed) are key diagnostics.</p><p>Two components are provided:</p><ul><li><code>COOxidation</code>: Full CO oxidation diagnostic system (Eqs. 6.9-6.17)</li><li><code>OzoneProductionEfficiency</code>: OPE diagnostic (Eqs. 6.21-6.24)</li></ul><p><strong>Reference</strong>: Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition. John Wiley &amp; Sons. Section 6.3, pp. 212-219.</p><article><details class="docstring" open="true"><summary id="GasChem.COOxidation"><a class="docstring-binding" href="#GasChem.COOxidation"><code>GasChem.COOxidation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">COOxidation(; name)</code></pre><p>ModelingToolkit System for CO oxidation chemistry diagnostics.</p><p>Implements diagnostic calculations for the CO oxidation mechanism (Eqs. 6.9-6.17) from Seinfeld &amp; Pandis Chapter 6, including HOx cycling and steady-state relationships.</p><p><strong>Input Variables</strong></p><ul><li><code>CO</code>, <code>OH</code>, <code>HO2</code>, <code>NO</code>, <code>NO2</code>, <code>O3</code>: Species concentrations [m⁻³]</li></ul><p><strong>Output Variables</strong></p><ul><li><code>P_O3</code>: Net ozone production rate [m⁻³ s⁻¹]</li><li><code>L_HOx</code>: Total HOx loss rate [m⁻³ s⁻¹]</li><li><code>chain_length</code>: HOx chain length (cycles before termination)</li><li><code>HO2_ss</code>: HO₂ steady-state concentration (high NOx limit) [m⁻³]</li></ul><p><strong>Rate Constants at 298 K</strong></p><ul><li>k<em>CO</em>OH = 2.4 × 10⁻¹³ cm³ molecule⁻¹ s⁻¹ = 2.4 × 10⁻¹⁹ m³ s⁻¹</li><li>k<em>HO2</em>NO = 8.1 × 10⁻¹² cm³ molecule⁻¹ s⁻¹ = 8.1 × 10⁻¹⁸ m³ s⁻¹</li><li>k<em>HO2</em>HO2 = 2.9 × 10⁻¹² cm³ molecule⁻¹ s⁻¹ = 2.9 × 10⁻¹⁸ m³ s⁻¹</li><li>k<em>OH</em>NO2 = 1.0 × 10⁻¹¹ cm³ molecule⁻¹ s⁻¹ = 1.0 × 10⁻¹⁷ m³ s⁻¹</li><li>k<em>HO2</em>O3 = 2.0 × 10⁻¹⁵ cm³ molecule⁻¹ s⁻¹ = 2.0 × 10⁻²¹ m³ s⁻¹</li><li>k<em>OH</em>O3 = 7.3 × 10⁻¹⁴ cm³ molecule⁻¹ s⁻¹ = 7.3 × 10⁻²⁰ m³ s⁻¹</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/co_oxidation.jl#L60-L87">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GasChem.OzoneProductionEfficiency"><a class="docstring-binding" href="#GasChem.OzoneProductionEfficiency"><code>GasChem.OzoneProductionEfficiency</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">OzoneProductionEfficiency(; name)</code></pre><p>ModelingToolkit System for calculating Ozone Production Efficiency (OPE).</p><p>OPE = Δ[O₃] / Δ[NOx] represents the number of ozone molecules produced per NOx molecule consumed. This is a key metric for understanding ozone-NOx-VOC chemistry in different regimes.</p><p>From Equations 6.21-6.24:</p><ul><li>At high NOx (VOC-limited): OPE is low</li><li>At low NOx (NOx-limited): OPE is high</li><li>The transition occurs near the &quot;ridge line&quot; in O₃-NOx-VOC space</li></ul><p><strong>Input Variables</strong></p><ul><li><code>OH</code>, <code>HO2</code>, <code>RO2</code>, <code>NO</code>, <code>NO2</code>: Species concentrations [m⁻³]</li></ul><p><strong>Output Variables</strong></p><ul><li><code>P_O3</code>: Gross ozone production rate [m⁻³ s⁻¹]</li><li><code>L_NOx</code>: NOx loss rate [m⁻³ s⁻¹]</li><li><code>OPE</code>: Ozone production efficiency [dimensionless]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/GasChem.jl/blob/feacb5bd6c4d15c29d0fed04a5a76b0d26ff40f6/src/co_oxidation.jl#L158-L182">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="COOxidation:-State-Variables"><a class="docs-heading-anchor" href="#COOxidation:-State-Variables">COOxidation: State Variables</a><a id="COOxidation:-State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#COOxidation:-State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities, GasChem

sys = COOxidation()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>12×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">L_OH</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">OH loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">OH concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">CO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">CO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">O3</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">O₃ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">L_HO2</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HO₂ loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">L_HOx</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">HOx loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">HO2_ss</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ steady-state (high NOx)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">P_O3</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Net O₃ production rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">chain_length</td><td style = "text-align: left;"></td><td style = "text-align: left;">HOx chain length (dimensionless)</td></tr></tbody></table></div><h3 id="COOxidation:-Parameters"><a class="docs-heading-anchor" href="#COOxidation:-Parameters">COOxidation: Parameters</a><a id="COOxidation:-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#COOxidation:-Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">k_CO_OH</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">CO + OH rate constant (2.4e-13 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">k_OH_NO2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">OH + NO₂ + M rate constant (1.0e-11 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">k_OH_O3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">OH + O₃ rate constant (7.3e-14 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">k_HO2_O3</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + O₃ rate constant (2.0e-15 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">k_HO2_HO2</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + HO₂ rate constant (2.9e-12 cm³/molec/s)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">two</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stoichiometric factor for HO₂ self-reaction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">k_HO2_NO</td><td style = "text-align: left;">m³ s⁻¹</td><td style = "text-align: left;">HO₂ + NO rate constant (8.1e-12 cm³/molec/s)</td></tr></tbody></table></div><h3 id="COOxidation:-Equations"><a class="docs-heading-anchor" href="#COOxidation:-Equations">COOxidation: Equations</a><a id="COOxidation:-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#COOxidation:-Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{L\_OH}\left( t \right) &amp;= \mathtt{k\_CO\_OH} ~ \mathtt{CO}\left( t \right) ~ \mathtt{OH}\left( t \right) + \mathtt{k\_OH\_NO2} ~ \mathtt{NO2}\left( t \right) ~ \mathtt{OH}\left( t \right) + \mathtt{k\_OH\_O3} ~ \mathtt{OH}\left( t \right) ~ \mathtt{O3}\left( t \right) \\
\mathtt{L\_HO2}\left( t \right) &amp;= \mathtt{k\_HO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right) + \mathtt{k\_HO2\_O3} ~ \mathtt{HO2}\left( t \right) ~ \mathtt{O3}\left( t \right) + \left( \mathtt{HO2}\left( t \right) \right)^{2} ~ \mathtt{k\_HO2\_HO2} ~ \mathtt{two} \\
\mathtt{L\_HOx}\left( t \right) &amp;= \mathtt{k\_OH\_NO2} ~ \mathtt{NO2}\left( t \right) ~ \mathtt{OH}\left( t \right) + \left( \mathtt{HO2}\left( t \right) \right)^{2} ~ \mathtt{k\_HO2\_HO2} ~ \mathtt{two} \\
\mathtt{HO2\_ss}\left( t \right) &amp;= \frac{\mathtt{k\_CO\_OH} ~ \mathtt{CO}\left( t \right) ~ \mathtt{OH}\left( t \right)}{\mathtt{k\_HO2\_NO} ~ \mathtt{NO}\left( t \right)} \\
\mathtt{P\_O3}\left( t \right) &amp;= \mathtt{k\_HO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right) - \mathtt{k\_HO2\_O3} ~ \mathtt{HO2}\left( t \right) ~ \mathtt{O3}\left( t \right) - \mathtt{k\_OH\_O3} ~ \mathtt{OH}\left( t \right) ~ \mathtt{O3}\left( t \right) \\
\mathtt{chain\_length}\left( t \right) &amp;= \frac{\mathtt{k\_HO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right)}{\mathtt{L\_HOx}\left( t \right)}
\end{align}
 \]</p><h3 id="OzoneProductionEfficiency:-State-Variables"><a class="docs-heading-anchor" href="#OzoneProductionEfficiency:-State-Variables">OzoneProductionEfficiency: State Variables</a><a id="OzoneProductionEfficiency:-State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#OzoneProductionEfficiency:-State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">ope_sys = OzoneProductionEfficiency()
vars_ope = unknowns(ope_sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars_ope],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars_ope],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars_ope]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">P_O3</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">Gross O₃ production rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">RO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Organic peroxy radical concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">NO</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">HO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">HO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">L_NOx</td><td style = "text-align: left;">m⁻³ s⁻¹</td><td style = "text-align: left;">NOx loss rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">OH</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">OH concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">NO2</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">NO₂ concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">OPE</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ozone Production Efficiency (dimensionless)</td></tr></tbody></table></div><h3 id="OzoneProductionEfficiency:-Equations"><a class="docs-heading-anchor" href="#OzoneProductionEfficiency:-Equations">OzoneProductionEfficiency: Equations</a><a id="OzoneProductionEfficiency:-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#OzoneProductionEfficiency:-Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(ope_sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{P\_O3}\left( t \right) &amp;= \mathtt{k\_HO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{HO2}\left( t \right) + \mathtt{k\_RO2\_NO} ~ \mathtt{NO}\left( t \right) ~ \mathtt{RO2}\left( t \right) \\
\mathtt{L\_NOx}\left( t \right) &amp;= \mathtt{k\_OH\_NO2} ~ \mathtt{NO2}\left( t \right) ~ \mathtt{OH}\left( t \right) \\
\mathtt{OPE}\left( t \right) &amp;= \frac{\mathtt{P\_O3}\left( t \right)}{\mathtt{L\_NOx}\left( t \right)}
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Figure-6.3:-OPE-vs-NOx-for-CO-Oxidation"><a class="docs-heading-anchor" href="#Figure-6.3:-OPE-vs-NOx-for-CO-Oxidation">Figure 6.3: OPE vs NOx for CO Oxidation</a><a id="Figure-6.3:-OPE-vs-NOx-for-CO-Oxidation-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-6.3:-OPE-vs-NOx-for-CO-Oxidation" title="Permalink"></a></h3><p>Figure 6.3 of Seinfeld &amp; Pandis shows the ozone production efficiency (OPE) for atmospheric CO oxidation at 298 K at the Earth&#39;s surface as a function of the NOx (NO + NO2) level. The conditions are: <span>$P_{HO_x} = 1$</span> ppt s⁻¹, <span>$[NO]/[NO_2] = 0.1$</span>, and CO mixing ratio of 200 ppb.</p><p>OPE is computed from Eqs. 6.10, 6.23, and 6.22 by solving the quadratic equation for [HO2] (Eq. 6.23 combined with 6.10) and then computing OPE = P(O3) / L(NOx). The <code>COOxidation</code> and <code>OzoneProductionEfficiency</code> systems are used to compute the diagnostics.</p><pre><code class="language-julia hljs">using Plots, NonlinearSolve

# Use the OPE system for computing OPE from given concentrations
ope_nns = ModelingToolkit.toggle_namespacing(ope_sys, false)
ope_inputs = [ope_nns.OH, ope_nns.HO2, ope_nns.RO2, ope_nns.NO, ope_nns.NO2]
ope_compiled = mtkcompile(ope_sys; inputs = ope_inputs)

# Extract rate constants from the COOxidation system parameters for the quadratic solve
# (Eqs. 6.10 and 6.23 require solving for HO2 analytically before using the system)
k_CO_OH = Float64(ModelingToolkit.getdefault(sys.k_CO_OH))
k_HO2_NO = Float64(ModelingToolkit.getdefault(sys.k_HO2_NO))
k_HO2_HO2 = Float64(ModelingToolkit.getdefault(sys.k_HO2_HO2))
k_OH_NO2 = Float64(ModelingToolkit.getdefault(sys.k_OH_NO2))

# Conditions from Figure 6.3 caption (working in SI: m⁻³)
M_val = 2.5e25              # total air at surface [m⁻³]
CO_val = 200e-9 * M_val     # 200 ppb CO [m⁻³]
NO_NO2_ratio = 0.1          # [NO]/[NO₂] = 0.1
P_HOx = 1e-12 * M_val       # 1 ppt/s [m⁻³/s]

# Vary NOx from 1 ppt to 10⁶ ppt (= 1 ppm)
NOx_ppt = 10 .^ range(0, 6, length = 300)
NOx = NOx_ppt .* 1e-12 .* M_val

# Partition NOx
NO2_vals = NOx ./ (1 + NO_NO2_ratio)
NO_vals = NO_NO2_ratio .* NO2_vals

# Solve quadratic for [HO2] from Eqs. 6.10 and 6.23
a_vals = 2 .* k_HO2_HO2 .* (1 .+ k_OH_NO2 .* NO2_vals ./ (k_CO_OH .* CO_val))
b_vals = k_HO2_NO .* k_OH_NO2 .* NO2_vals .* NO_vals ./ (k_CO_OH .* CO_val)
c_val = -P_HOx

HO2_vals = (-b_vals .+ sqrt.(b_vals .^ 2 .- 4 .* a_vals .* c_val)) ./ (2 .* a_vals)
OH_vals = (P_HOx .- 2 .* k_HO2_HO2 .* HO2_vals .^ 2) ./ (k_OH_NO2 .* NO2_vals)

# Compute OPE using the OPE system
OPE_vals = Float64[]
prob = NonlinearProblem(ope_compiled,
    Dict(ope_compiled.OH =&gt; OH_vals[1], ope_compiled.HO2 =&gt; HO2_vals[1],
        ope_compiled.RO2 =&gt; 0.0, ope_compiled.NO =&gt; NO_vals[1],
        ope_compiled.NO2 =&gt; NO2_vals[1]);
    build_initializeprob = false)

for i in eachindex(NOx_ppt)
    newprob = remake(prob,
        p = [
            ope_compiled.OH =&gt; OH_vals[i], ope_compiled.HO2 =&gt; HO2_vals[i],
            ope_compiled.NO =&gt; NO_vals[i], ope_compiled.NO2 =&gt; NO2_vals[i]])
    sol = solve(newprob)
    push!(OPE_vals, sol[ope_compiled.OPE])
end

plot(NOx_ppt, OPE_vals,
    xlabel = &quot;NOₓ (ppt)&quot;,
    ylabel = &quot;Ozone Production Efficiency&quot;,
    title = &quot;Figure 6.3: OPE for CO Oxidation&quot;,
    xscale = :log10,
    linewidth = 2, label = &quot;OPE (Eqs. 6.10, 6.22, 6.23)&quot;,
    legend = :topright,
    ylims = (0, 9),
    size = (600, 400))
annotate!([(
    1e4, 7, text(&quot;P_HOx = 1 ppt/s\n[NO]/[NO₂] = 0.1\nCO = 200 ppb\nT = 298 K&quot;, 8, :left))])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/GasChem.jl/GasChem.jl/docs/build/co_fig6_3.svg&quot;</code></pre><p><img src="../co_fig6_3.svg" alt="Figure 6.3: OPE vs NOx"/></p><p>The OPE is largest at the lowest NOx concentrations; at these low levels, NOx termination by OH + NO₂ is suppressed and each NOx molecule participates in more O₃ production cycles. At 100 ppb NOx, OPE approaches zero as the OH + NO₂ reaction occurs preferentially relative to propagation of the cycle. This reproduces Figure 6.3 of Seinfeld &amp; Pandis.</p><h3 id="Figure-6.4:-CO-Oxidation-Characteristics-vs-NO"><a class="docs-heading-anchor" href="#Figure-6.4:-CO-Oxidation-Characteristics-vs-NO">Figure 6.4: CO Oxidation Characteristics vs NO</a><a id="Figure-6.4:-CO-Oxidation-Characteristics-vs-NO-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-6.4:-CO-Oxidation-Characteristics-vs-NO" title="Permalink"></a></h3><p>Figure 6.4 shows [HO₂], P(O₃), and the HOx loss terms HHL and NHL as functions of [NO] for three values of <span>$P_{HO_x}$</span> (0.1, 0.6, and 1.2 ppt s⁻¹). Conditions: 298 K, <span>$[NO_2]/[NO] = 7$</span>.</p><p>The <code>COOxidation</code> system is used to compute P(O₃) and the HOx loss diagnostics from the computed OH and HO₂ concentrations.</p><ul><li>HHL = <span>$2 k_{HO_2+HO_2} [HO_2]^2$</span> (HOx loss via HO₂ self-reaction, Eq. 6.11)</li><li>NHL = <span>$k_{OH+NO_2} [OH] [NO_2]$</span> (HOx loss via OH+NO₂, Eq. 6.12)</li></ul><pre><code class="language-julia hljs">sys_nns = ModelingToolkit.toggle_namespacing(sys, false)
co_inputs = [sys_nns.CO, sys_nns.OH, sys_nns.HO2, sys_nns.NO, sys_nns.NO2, sys_nns.O3]
co_compiled = mtkcompile(sys; inputs = co_inputs)

# Conditions from Figure 6.4 caption (working in SI: m⁻³)
M_val = 2.5e25
NO2_NO_ratio = 7.0
P_HOx_ppt = [0.1, 0.6, 1.2]
P_HOx_SI = P_HOx_ppt .* 1e-12 .* M_val  # m⁻³/s

# Vary NO from 0 to 6e10 molec/cm³ (= 6e16 m⁻³)
NO_range_cgs = range(1e8, 6e10, length = 500)
NO_range = NO_range_cgs .* 1e6   # convert to m⁻³
NO2_range = NO2_NO_ratio .* NO_range

# CO = 200 ppb
CO_val = 200e-9 * M_val

p_ho2 = plot(title = &quot;(a) [HO₂]&quot;, xlabel = &quot;NO (molec cm⁻³)&quot;, ylabel = &quot;HO₂ (molec cm⁻³)&quot;)
p_po3 = plot(title = &quot;(b) P(O₃)&quot;, xlabel = &quot;NO (molec cm⁻³)&quot;,
    ylabel = &quot;P_O₃ (molec cm⁻³ s⁻¹)&quot;)
p_hhl = plot(title = &quot;(c) HHL and NHL&quot;, xlabel = &quot;NO (molec cm⁻³)&quot;,
    ylabel = &quot;HHL, NHL (molec cm⁻³ s⁻¹)&quot;)

for (i, P_HOx) in enumerate(P_HOx_SI)
    lbl = &quot;P_HOx = $(P_HOx_ppt[i]) ppt/s&quot;

    # Solve quadratic for HO2 (SI units, using rate constants from system)
    a_v = 2 .* k_HO2_HO2 .* (1 .+ k_OH_NO2 .* NO2_range ./ (k_CO_OH .* CO_val))
    b_v = k_HO2_NO .* k_OH_NO2 .* NO2_range .* NO_range ./ (k_CO_OH .* CO_val)
    c_v = -P_HOx

    HO2_v = (-b_v .+ sqrt.(b_v .^ 2 .- 4 .* a_v .* c_v)) ./ (2 .* a_v)
    OH_v = (P_HOx .- 2 .* k_HO2_HO2 .* HO2_v .^ 2) ./ (k_OH_NO2 .* NO2_range)

    # Use COOxidation system to compute diagnostics
    PO3_v = Float64[]
    L_HOx_v = Float64[]
    NHL_v = Float64[]

    co_prob = NonlinearProblem(co_compiled,
        Dict(co_compiled.CO =&gt; CO_val, co_compiled.OH =&gt; OH_v[1],
            co_compiled.HO2 =&gt; HO2_v[1], co_compiled.NO =&gt; NO_range[1],
            co_compiled.NO2 =&gt; NO2_range[1], co_compiled.O3 =&gt; 1e18);
        build_initializeprob = false)

    for j in eachindex(NO_range)
        newprob = remake(co_prob,
            p = [
                co_compiled.OH =&gt; OH_v[j], co_compiled.HO2 =&gt; HO2_v[j],
                co_compiled.NO =&gt; NO_range[j], co_compiled.NO2 =&gt; NO2_range[j]])
        sol = solve(newprob)
        push!(PO3_v, sol[co_compiled.P_O3])
        push!(L_HOx_v, sol[co_compiled.L_HOx])
        # NHL = k_OH_NO2 * [OH] * [NO2] (Eq. 6.12)
        push!(NHL_v, k_OH_NO2 * OH_v[j] * NO2_range[j])
    end

    # HHL = L_HOx - NHL (since L_HOx = HHL + NHL)
    HHL_v = L_HOx_v .- NHL_v

    # Convert to cgs for plotting (m⁻³ → cm⁻³ = ×1e-6)
    plot!(p_ho2, NO_range_cgs, HO2_v .* 1e-6, label = lbl, linewidth = 2)
    plot!(p_po3, NO_range_cgs, PO3_v .* 1e-6, label = lbl, linewidth = 2)
    plot!(p_hhl, NO_range_cgs, HHL_v .* 1e-6, label = &quot;HHL &quot; * lbl, linewidth = 2,
        linestyle = :solid)
    plot!(p_hhl, NO_range_cgs, NHL_v .* 1e-6, label = &quot;NHL &quot; * lbl, linewidth = 2,
        linestyle = :dash)
end

plot(p_ho2, p_po3, p_hhl, layout = (3, 1), size = (600, 900), left_margin = 5 * Plots.mm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/GasChem.jl/GasChem.jl/docs/build/co_fig6_4.svg&quot;</code></pre><p><img src="../co_fig6_4.svg" alt="Figure 6.4: CO oxidation characteristics vs NO"/></p><p>Panel (a) shows that [HO₂] decreases with [NO] because the HO₂ + NO reaction consumes HO₂ more efficiently at higher NO. Panel (b) shows that P(O₃) achieves a maximum at an intermediate [NO]; at low [NO], HO₂ is abundant but there is insufficient NO for the O₃-producing HO₂ + NO reaction, while at high [NO], HO₂ is depleted. Panel (c) shows the crossover from HHL-dominated (low NOx, HO₂ self-reaction) to NHL-dominated (high NOx, OH + NO₂) HOx termination. The maximum in P(O₃) occurs at a larger [NO] than the HHL/NHL crossover. This reproduces Figure 6.4 of Seinfeld &amp; Pandis.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nox_photochemistry/">« NOx Photochemistry</a><a class="docs-footer-nextpage" href="../methane_oxidation/">Methane Oxidation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 21 February 2026 21:06">Saturday 21 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
