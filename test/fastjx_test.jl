using GasChem
using Test

#   Unit Test 0: O3 -> O2 + O(1D)
@test begin
    u_0 = [
        [
            0.48419999999999996,
            0.49219999999999997,
            0.5071,
            0.5228,
            0.6040000000000001,
            0.6803,
            0.7190000000000001,
            0.7549000000000001,
            0.9,
            0.8989000000000001,
            0.8929,
            0.9,
            0.8901,
            0.41300000000000003,
            0.08985,
            0.06782,
            0.0,
            0.0,
        ],
        [
            0.4842333333333333,
            0.49219999999999997,
            0.5071333333333333,
            0.5228333333333334,
            0.6040000000000001,
            0.6802666666666667,
            0.7189666666666668,
            0.7549000000000001,
            0.9,
            0.8989000000000001,
            0.8929,
            0.9,
            0.8906000000000001,
            0.4305333333333334,
            0.10713333333333333,
            0.06853000000000001,
            0.0,
            0.0,
        ],
        [
            0.4843,
            0.49219999999999997,
            0.5072,
            0.5229,
            0.6040000000000001,
            0.6804,
            0.7189000000000001,
            0.7549666666666667,
            0.9,
            0.8989000000000001,
            0.8929,
            0.9,
            0.895,
            0.5453333333333333,
            0.24183333333333334,
            0.55285,
            0.0,
            0.0,
        ],
        [
            0.4843,
            0.49219999999999997,
            0.5072,
            0.5229,
            0.6040000000000001,
            0.6805,
            0.7189000000000001,
            0.755,
            0.9,
            0.8989000000000001,
            0.8929,
            0.9,
            0.8967,
            0.5852,
            0.2919,
            0.7943,
            0.0,
            0.0,
        ],
    ]

    test_0 =
        [calc_J_o31D(1, 100), calc_J_o31D(1, 220), calc_J_o31D(1, 300), calc_J_o31D(1, 400)]

    test_0 ≈ u_0
end

#   Unit Test 1: H2O2 -> OH + OH
@test begin
    u_1 = [
        [
            2.325e-19,
            4.629e-19,
            5.394e-19,
            5.429e-19,
            4.447e-19,
            3.755e-19,
            3.4569999999999997e-19,
            3.197e-19,
            5.3460000000000004e-20,
            4.8550000000000005e-20,
            3.423e-20,
            8.407e-21,
            5.029e-21,
            3.308e-21,
            2.221e-21,
            8.598e-22,
            1.807e-23,
            0.0,
        ],
        [
            2.325e-19,
            4.629e-19,
            5.394e-19,
            5.429e-19,
            4.447e-19,
            3.755e-19,
            3.4569999999999997e-19,
            3.197e-19,
            5.4055000000000003e-20,
            4.910500000000001e-20,
            3.4735e-20,
            8.880499999999999e-21,
            5.396e-21,
            3.6095e-21,
            2.4695e-21,
            9.989e-22,
            2.113e-23,
            0.0,
        ],
        [
            2.325e-19,
            4.629e-19,
            5.394e-19,
            5.429e-19,
            4.447e-19,
            3.755e-19,
            3.4569999999999997e-19,
            3.197e-19,
            5.465e-20,
            4.9660000000000004e-20,
            3.5240000000000003e-20,
            9.353999999999999e-21,
            5.763e-21,
            3.911e-21,
            2.7179999999999997e-21,
            1.138e-21,
            2.4190000000000002e-23,
            0.0,
        ],
    ]

    test_1 = [calc_J_H2O2(1, 150), calc_J_H2O2(1, 250), calc_J_H2O2(1, 350)]

    test_1 ≈ u_1
end

# Unit Test 2: CH2O -> H + HO2 + CO
@test begin
    u_2 = [
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.143e-21,
            1.0209999999999999e-20,
            1.2689999999999998e-20,
            2.3229999999999997e-20,
            2.498e-20,
            1.133e-20,
            2.1829999999999996e-20,
            4.746e-21,
            0.0,
            0.0,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.1444399999999997e-21,
            1.01992e-20,
            1.2679199999999999e-20,
            2.3201199999999998e-20,
            2.49764e-20,
            1.1322799999999999e-20,
            2.1851599999999997e-20,
            4.7478e-21,
            0.0,
            0.0,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.1469999999999998e-21,
            1.018e-20,
            1.266e-20,
            2.3149999999999998e-20,
            2.497e-20,
            1.131e-20,
            2.189e-20,
            4.7510000000000005e-21,
            0.0,
            0.0,
        ],
    ]

    test_2 = [calc_J_CH2Oa(1, 200), calc_J_CH2Oa(1, 250), calc_J_CH2Oa(1, 300)]

    test_2 ≈ u_2
end
# Unit Test 3: CH2O -> CO + H2
@test begin
    u_3 = [
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.642000000000004e-21,
            5.787000000000007e-21,
            5.316000000000006e-21,
            8.181000000000008e-21,
            7.91700000000001e-21,
            4.011000000000005e-21,
            1.0810000000000012e-20,
            0.20675441138756934,
            9.245472789043451e-8,
            0.0,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.644520000000004e-21,
            5.7801600000000065e-21,
            5.3120400000000064e-21,
            8.17128000000001e-21,
            7.91592000000001e-21,
            4.007760000000005e-21,
            1.0824400000000013e-20,
            0.13232282328804437,
            9.500679548341345e-8,
            0.0,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.6490000000000045e-21,
            5.768000000000007e-21,
            5.305000000000006e-21,
            8.15400000000001e-21,
            7.914000000000009e-21,
            4.002000000000005e-21,
            1.0850000000000013e-20,
            1.0850000000000013e-20,
            9.954380453759824e-8,
            0.0,
        ],
    ]

    test_3 = [calc_J_CH2Ob(1, 200), calc_J_CH2Ob(1, 250), calc_J_CH2Ob(1, 300)]

    test_3 ≈ u_3
end

# Unit Test 4: CH3OOH -> OH + HO2 + CH2O
@test begin
    u_4 = [[
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        3.1200000000000034e-19,
        2.882000000000003e-19,
        2.2500000000000025e-19,
        2.716000000000003e-20,
        2.740000000000003e-20,
        2.1430000000000022e-20,
        5.624000000000006e-21,
        3.520000000000004e-21,
        2.4030000000000024e-21,
        1.697000000000002e-21,
        7.230000000000008e-22,
        6.973000000000007e-23,
        0.0,
    ]]

    test_4 = [calc_J_CH3OOH(1, 200)]

    test_4 ≈ u_4
end

# Unit Test 5: NO2 -> NO + O
@test begin
    u_5 = [
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            1.8349999999999998e-20,
            4.6929999999999996e-20,
            7.705e-20,
            1.078e-19,
            1.47e-19,
            1.832e-19,
            2.181e-19,
            3.1379999999999997e-19,
            4.3209999999999995e-19,
            1.3859999999999998e-22,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            2.0892553191489374e-20,
            4.69353191489362e-20,
            7.624148936170218e-20,
            1.0700212765957453e-19,
            1.47372340425532e-19,
            1.8516808510638306e-19,
            2.241638297872342e-19,
            3.3028936170212783e-19,
            4.4922765957446835e-19,
            2.959936170212768e-22,
        ],
        [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            2.3130000000000027e-20,
            4.6940000000000055e-20,
            7.553000000000009e-20,
            1.0630000000000011e-19,
            1.4770000000000016e-19,
            1.8690000000000019e-19,
            2.2950000000000025e-19,
            3.4480000000000037e-19,
            4.643000000000005e-19,
            4.345000000000004e-22,
        ],
    ]

    test_5 = [calc_J_NO2(1, 150), calc_J_NO2(1, 250), calc_J_NO2(1, 300)]

    test_5 ≈ u_5
end
